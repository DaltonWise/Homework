{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/DaltonWise/Homework/blob/main/HDS%20Week%2011%3A%20Filtering%20Multiple%20filters.\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "**Multiple Filters**\n",
        "\n",
        "This is the section part of the lecture on filtering from week 11.\n",
        "\n",
        "We start by importing pandas and reading the csv."
      ],
      "metadata": {
        "id": "b_llm4NEVRqh"
      }
    },
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "id": "LbHMyPnadnBV"
      },
      "outputs": [],
      "source": [
        "import pandas as pd"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#We were actually able to read this csv into colab because it is an online amazon link to the csv."
      ],
      "metadata": {
        "id": "HSiVMVgid4Z0"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "execution_count": 2,
      "metadata": {
        "id": "GpSMNRy-dnBW"
      },
      "outputs": [],
      "source": [
        "data = pd.read_csv('https://hds5210-data.s3.amazonaws.com/complications.csv')"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "data['compared_to_national'].value_counts()"
      ],
      "metadata": {
        "id": "tt-soG_vd5BC",
        "outputId": "55e1fcbf-e63d-47e3-d606-4438f715ab20",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "No Different Than the National Rate     666\n",
              "Not Available                           143\n",
              "Number of Cases Too Small               114\n",
              "No Different Than the National Value     50\n",
              "Worse Than the National Rate             22\n",
              "Better Than the National Rate             3\n",
              "Worse Than the National Value             1\n",
              "Better Than the National Value            1\n",
              "Name: compared_to_national, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 3
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "w-xwd3wqdnBX"
      },
      "source": [
        "# Multiple Filters\n",
        "\n",
        "Where the **Compared to National** is not `Number of Cases Too Small` and the Denominator is not `Not Available`, except we want all the mortality related measures regardless of those first two rules."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 3,
      "metadata": {
        "id": "LTGtcsipdnBY"
      },
      "outputs": [],
      "source": [
        "#We create three filters.\n",
        "#Each filter is choosing a column value that must be met.\n",
        "#Mortality is only choosing from the measue ID where the word ^MORT is in the value.\n",
        "\n",
        "too_small = data['compared_to_national'] == 'Number of Cases Too Small'\n",
        "not_avail = data['denominator'] == 'Not Available'\n",
        "mortality = data['measure_id'].str.contains(\"^MORT\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "rSa1Ss3cdnBY",
        "outputId": "d0c5d717-7adb-4b4e-8873-cb9f5548114f",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "(1000, 18)"
            ]
          },
          "metadata": {},
          "execution_count": 5
        }
      ],
      "source": [
        "data.shape"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "w-7Z5t-sdnBY",
        "outputId": "1eb74a69-1546-45d2-c1ed-3eb34b285e0f",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "(114, 18)"
            ]
          },
          "metadata": {},
          "execution_count": 6
        }
      ],
      "source": [
        "data[too_small].shape"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "tGFbuxBqdnBZ",
        "outputId": "c717b53d-1d7f-4ffe-9d84-901d01ba855d",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "(309, 18)"
            ]
          },
          "metadata": {},
          "execution_count": 7
        }
      ],
      "source": [
        "data[not_avail].shape"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "9Dt2QKsGdnBZ",
        "outputId": "f17a114a-08a1-4938-d867-f47ca1f0be55",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "(318, 18)"
            ]
          },
          "metadata": {},
          "execution_count": 8
        }
      ],
      "source": [
        "data[mortality].shape"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "qI44pQJ4dnBZ"
      },
      "outputs": [],
      "source": [
        "#We create a new data set using each of the filters.\n",
        "#We ask for all the mortality measures that meet the filter OR all the rows that do not meat both of the other filters.\n",
        "\n",
        "subset = data[mortality & (~too_small & ~not_avail)]"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "HEDYyNO4dnBZ",
        "outputId": "749ab0ec-994f-49ec-9c38-5c9aec8c196f",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "(224, 18)"
            ]
          },
          "metadata": {},
          "execution_count": 10
        }
      ],
      "source": [
        "subset.shape"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "subset['measure_id'].value_counts()"
      ],
      "metadata": {
        "id": "ngQdNFT7fFq1",
        "outputId": "97f50b35-4a49-48de-f21c-3173fb386425",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "MORT_30_PN      51\n",
              "MORT_30_COPD    48\n",
              "MORT_30_HF      46\n",
              "MORT_30_STK     36\n",
              "MORT_30_AMI     26\n",
              "MORT_30_CABG    17\n",
              "Name: measure_id, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 12
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "subset['compared_to_national'].value_counts()"
      ],
      "metadata": {
        "id": "dCsg_2uZfKK8",
        "outputId": "a7bb3edb-01a7-4bd3-aff2-a766279f4e96",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "No Different Than the National Rate    212\n",
              "Worse Than the National Rate             9\n",
              "Better Than the National Rate            3\n",
              "Name: compared_to_national, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 13
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "subset['denominator'].value_counts()"
      ],
      "metadata": {
        "id": "ae1te7nDfQXS",
        "outputId": "6b5a2ce9-0c03-42e9-b8b7-c6bd2618e11b",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "29     5\n",
              "85     4\n",
              "73     3\n",
              "79     3\n",
              "113    3\n",
              "      ..\n",
              "612    1\n",
              "502    1\n",
              "70     1\n",
              "158    1\n",
              "385    1\n",
              "Name: denominator, Length: 182, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 14
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "rDsyBFPQdnBZ",
        "outputId": "907da212-574d-4d3f-e0a2-6c38ca5a2995",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 486
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "   provider_id                     hospital_name                 address  \\\n",
              "1        10001  SOUTHEAST ALABAMA MEDICAL CENTER  1108 ROSS CLARK CIRCLE   \n",
              "2        10001  SOUTHEAST ALABAMA MEDICAL CENTER  1108 ROSS CLARK CIRCLE   \n",
              "3        10001  SOUTHEAST ALABAMA MEDICAL CENTER  1108 ROSS CLARK CIRCLE   \n",
              "4        10001  SOUTHEAST ALABAMA MEDICAL CENTER  1108 ROSS CLARK CIRCLE   \n",
              "5        10001  SOUTHEAST ALABAMA MEDICAL CENTER  1108 ROSS CLARK CIRCLE   \n",
              "\n",
              "     city state  zip_code county_name    phone_number    measure_id  \\\n",
              "1  DOTHAN    AL     36301     HOUSTON  (334) 793-8701   MORT_30_AMI   \n",
              "2  DOTHAN    AL     36301     HOUSTON  (334) 793-8701  MORT_30_CABG   \n",
              "3  DOTHAN    AL     36301     HOUSTON  (334) 793-8701  MORT_30_COPD   \n",
              "4  DOTHAN    AL     36301     HOUSTON  (334) 793-8701    MORT_30_HF   \n",
              "5  DOTHAN    AL     36301     HOUSTON  (334) 793-8701    MORT_30_PN   \n",
              "\n",
              "                            measure_name                 compared_to_national  \\\n",
              "1   Death rate for heart attack patients  No Different Than the National Rate   \n",
              "2   Death rate for CABG surgery patients  No Different Than the National Rate   \n",
              "3           Death rate for COPD patients  No Different Than the National Rate   \n",
              "4  Death rate for heart failure patients  No Different Than the National Rate   \n",
              "5      Death rate for pneumonia patients  No Different Than the National Rate   \n",
              "\n",
              "  denominator score lower_estimate higher_estimate  footnote  \\\n",
              "1         688    13           11.0            15.5       NaN   \n",
              "2         291   4.3            2.6             6.8       NaN   \n",
              "3         411   8.8            6.7            11.4       NaN   \n",
              "4         869  12.7           10.7            15.0       NaN   \n",
              "5         560    17           14.4            20.0       NaN   \n",
              "\n",
              "        measure_start_date         measure_end_date  \n",
              "1  2015-07-01T00:00:00.000  2018-06-30T00:00:00.000  \n",
              "2  2015-07-01T00:00:00.000  2018-06-30T00:00:00.000  \n",
              "3  2015-07-01T00:00:00.000  2018-06-30T00:00:00.000  \n",
              "4  2015-07-01T00:00:00.000  2018-06-30T00:00:00.000  \n",
              "5  2015-07-01T00:00:00.000  2018-06-30T00:00:00.000  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-88c2fb24-1f4d-4a0a-97e7-66d6a8a5c3a5\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>provider_id</th>\n",
              "      <th>hospital_name</th>\n",
              "      <th>address</th>\n",
              "      <th>city</th>\n",
              "      <th>state</th>\n",
              "      <th>zip_code</th>\n",
              "      <th>county_name</th>\n",
              "      <th>phone_number</th>\n",
              "      <th>measure_id</th>\n",
              "      <th>measure_name</th>\n",
              "      <th>compared_to_national</th>\n",
              "      <th>denominator</th>\n",
              "      <th>score</th>\n",
              "      <th>lower_estimate</th>\n",
              "      <th>higher_estimate</th>\n",
              "      <th>footnote</th>\n",
              "      <th>measure_start_date</th>\n",
              "      <th>measure_end_date</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>10001</td>\n",
              "      <td>SOUTHEAST ALABAMA MEDICAL CENTER</td>\n",
              "      <td>1108 ROSS CLARK CIRCLE</td>\n",
              "      <td>DOTHAN</td>\n",
              "      <td>AL</td>\n",
              "      <td>36301</td>\n",
              "      <td>HOUSTON</td>\n",
              "      <td>(334) 793-8701</td>\n",
              "      <td>MORT_30_AMI</td>\n",
              "      <td>Death rate for heart attack patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>688</td>\n",
              "      <td>13</td>\n",
              "      <td>11.0</td>\n",
              "      <td>15.5</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>10001</td>\n",
              "      <td>SOUTHEAST ALABAMA MEDICAL CENTER</td>\n",
              "      <td>1108 ROSS CLARK CIRCLE</td>\n",
              "      <td>DOTHAN</td>\n",
              "      <td>AL</td>\n",
              "      <td>36301</td>\n",
              "      <td>HOUSTON</td>\n",
              "      <td>(334) 793-8701</td>\n",
              "      <td>MORT_30_CABG</td>\n",
              "      <td>Death rate for CABG surgery patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>291</td>\n",
              "      <td>4.3</td>\n",
              "      <td>2.6</td>\n",
              "      <td>6.8</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>10001</td>\n",
              "      <td>SOUTHEAST ALABAMA MEDICAL CENTER</td>\n",
              "      <td>1108 ROSS CLARK CIRCLE</td>\n",
              "      <td>DOTHAN</td>\n",
              "      <td>AL</td>\n",
              "      <td>36301</td>\n",
              "      <td>HOUSTON</td>\n",
              "      <td>(334) 793-8701</td>\n",
              "      <td>MORT_30_COPD</td>\n",
              "      <td>Death rate for COPD patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>411</td>\n",
              "      <td>8.8</td>\n",
              "      <td>6.7</td>\n",
              "      <td>11.4</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>10001</td>\n",
              "      <td>SOUTHEAST ALABAMA MEDICAL CENTER</td>\n",
              "      <td>1108 ROSS CLARK CIRCLE</td>\n",
              "      <td>DOTHAN</td>\n",
              "      <td>AL</td>\n",
              "      <td>36301</td>\n",
              "      <td>HOUSTON</td>\n",
              "      <td>(334) 793-8701</td>\n",
              "      <td>MORT_30_HF</td>\n",
              "      <td>Death rate for heart failure patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>869</td>\n",
              "      <td>12.7</td>\n",
              "      <td>10.7</td>\n",
              "      <td>15.0</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>5</th>\n",
              "      <td>10001</td>\n",
              "      <td>SOUTHEAST ALABAMA MEDICAL CENTER</td>\n",
              "      <td>1108 ROSS CLARK CIRCLE</td>\n",
              "      <td>DOTHAN</td>\n",
              "      <td>AL</td>\n",
              "      <td>36301</td>\n",
              "      <td>HOUSTON</td>\n",
              "      <td>(334) 793-8701</td>\n",
              "      <td>MORT_30_PN</td>\n",
              "      <td>Death rate for pneumonia patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>560</td>\n",
              "      <td>17</td>\n",
              "      <td>14.4</td>\n",
              "      <td>20.0</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-88c2fb24-1f4d-4a0a-97e7-66d6a8a5c3a5')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-88c2fb24-1f4d-4a0a-97e7-66d6a8a5c3a5 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-88c2fb24-1f4d-4a0a-97e7-66d6a8a5c3a5');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-a41a029a-88db-445e-b3e3-cebbe9fd1b47\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-a41a029a-88db-445e-b3e3-cebbe9fd1b47')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-a41a029a-88db-445e-b3e3-cebbe9fd1b47 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 11
        }
      ],
      "source": [
        "subset.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "L5wQRZbidnBZ"
      },
      "outputs": [],
      "source": [
        "subset[mortality & too_small].head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "OnmwfSEYdnBZ"
      },
      "outputs": [],
      "source": [
        "subset[mortality & too_small].shape"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "data[data['city'] == 'DADEVILLE' | data['city'] == 'BIRMINGHAM']"
      ],
      "metadata": {
        "id": "J2MtseeuhBWU"
      },
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "g-2MEeWfdnBZ",
        "outputId": "2cd1019d-f648-4869-9c8c-2bc75372683e",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "BIRMINGHAM    76\n",
              "DADEVILLE     19\n",
              "Name: city, dtype: int64"
            ]
          },
          "metadata": {},
          "execution_count": 17
        }
      ],
      "source": [
        "birmingham = data['city'] == 'BIRMINGHAM'\n",
        "dadeville = data['city'] == 'DADEVILLE'\n",
        "data[birmingham | dadeville]\n",
        "\n",
        "data[birmingham | dadeville]['city'].value_counts()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "rAAn7epGdnBa"
      },
      "source": [
        "# DataFrame.query()\n",
        "\n",
        "This is another way we can do a complex filter, using the query function.\n"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "#\n",
        "data.query('city in (\"DADEVILLE\", \"BIRMINGHAM\")')"
      ],
      "metadata": {
        "id": "d1eN_5YAgdMT",
        "outputId": "b7c35563-8599-4445-c1d2-d606ee73241c",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        }
      },
      "execution_count": 4,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "     provider_id            hospital_name                     address  \\\n",
              "95         10011        ST VINCENT'S EAST  50 MEDICAL PARK EAST DRIVE   \n",
              "96         10011        ST VINCENT'S EAST  50 MEDICAL PARK EAST DRIVE   \n",
              "97         10011        ST VINCENT'S EAST  50 MEDICAL PARK EAST DRIVE   \n",
              "98         10011        ST VINCENT'S EAST  50 MEDICAL PARK EAST DRIVE   \n",
              "99         10011        ST VINCENT'S EAST  50 MEDICAL PARK EAST DRIVE   \n",
              "..           ...                      ...                         ...   \n",
              "565        10056  ST VINCENT'S BIRMINGHAM      810 ST VINCENT'S DRIVE   \n",
              "566        10056  ST VINCENT'S BIRMINGHAM      810 ST VINCENT'S DRIVE   \n",
              "567        10056  ST VINCENT'S BIRMINGHAM      810 ST VINCENT'S DRIVE   \n",
              "568        10056  ST VINCENT'S BIRMINGHAM      810 ST VINCENT'S DRIVE   \n",
              "569        10056  ST VINCENT'S BIRMINGHAM      810 ST VINCENT'S DRIVE   \n",
              "\n",
              "           city state  zip_code county_name    phone_number       measure_id  \\\n",
              "95   BIRMINGHAM    AL     35235   JEFFERSON  (205) 838-3122    COMP_HIP_KNEE   \n",
              "96   BIRMINGHAM    AL     35235   JEFFERSON  (205) 838-3122      MORT_30_AMI   \n",
              "97   BIRMINGHAM    AL     35235   JEFFERSON  (205) 838-3122     MORT_30_CABG   \n",
              "98   BIRMINGHAM    AL     35235   JEFFERSON  (205) 838-3122     MORT_30_COPD   \n",
              "99   BIRMINGHAM    AL     35235   JEFFERSON  (205) 838-3122       MORT_30_HF   \n",
              "..          ...   ...       ...         ...             ...              ...   \n",
              "565  BIRMINGHAM    AL     35205   JEFFERSON  (205) 939-7000  PSI_4_SURG_COMP   \n",
              "566  BIRMINGHAM    AL     35205   JEFFERSON  (205) 939-7000    PSI_6_IAT_PTX   \n",
              "567  BIRMINGHAM    AL     35205   JEFFERSON  (205) 939-7000   PSI_8_POST_HIP   \n",
              "568  BIRMINGHAM    AL     35205   JEFFERSON  (205) 939-7000    PSI_90_SAFETY   \n",
              "569  BIRMINGHAM    AL     35205   JEFFERSON  (205) 939-7000   PSI_9_POST_HEM   \n",
              "\n",
              "                                          measure_name  \\\n",
              "95   Rate of complications for hip/knee replacement...   \n",
              "96                Death rate for heart attack patients   \n",
              "97                Death rate for CABG surgery patients   \n",
              "98                        Death rate for COPD patients   \n",
              "99               Death rate for heart failure patients   \n",
              "..                                                 ...   \n",
              "565  Deaths among Patients with Serious Treatable C...   \n",
              "566            Collapsed lung due to medical treatment   \n",
              "567               Broken hip from a fall after surgery   \n",
              "568                              Serious complications   \n",
              "569          Perioperative Hemorrhage or Hematoma Rate   \n",
              "\n",
              "                     compared_to_national    denominator   score  \\\n",
              "95    No Different Than the National Rate            107     2.9   \n",
              "96    No Different Than the National Rate            170    14.8   \n",
              "97    No Different Than the National Rate            103       3   \n",
              "98    No Different Than the National Rate            257    10.5   \n",
              "99    No Different Than the National Rate            400    11.3   \n",
              "..                                    ...            ...     ...   \n",
              "565   No Different Than the National Rate            153  161.36   \n",
              "566   No Different Than the National Rate          10106    0.26   \n",
              "567   No Different Than the National Rate           9282    0.11   \n",
              "568  No Different Than the National Value  Not Available    0.98   \n",
              "569   No Different Than the National Rate           4662    2.42   \n",
              "\n",
              "    lower_estimate higher_estimate  footnote       measure_start_date  \\\n",
              "95             1.7             4.7       NaN  2015-04-01T00:00:00.000   \n",
              "96            11.7            18.4       NaN  2015-07-01T00:00:00.000   \n",
              "97             1.6             5.3       NaN  2015-07-01T00:00:00.000   \n",
              "98             8.0            13.6       NaN  2015-07-01T00:00:00.000   \n",
              "99             9.0            13.8       NaN  2015-07-01T00:00:00.000   \n",
              "..             ...             ...       ...                      ...   \n",
              "565         123.41          199.31       NaN  2016-07-01T00:00:00.000   \n",
              "566           0.07            0.46       NaN  2016-07-01T00:00:00.000   \n",
              "567           0.02            0.19       NaN  2016-07-01T00:00:00.000   \n",
              "568           0.77             1.2       NaN  2016-07-01T00:00:00.000   \n",
              "569           1.31            3.54       NaN  2016-07-01T00:00:00.000   \n",
              "\n",
              "            measure_end_date  \n",
              "95   2018-03-31T00:00:00.000  \n",
              "96   2018-06-30T00:00:00.000  \n",
              "97   2018-06-30T00:00:00.000  \n",
              "98   2018-06-30T00:00:00.000  \n",
              "99   2018-06-30T00:00:00.000  \n",
              "..                       ...  \n",
              "565  2018-06-30T00:00:00.000  \n",
              "566  2018-06-30T00:00:00.000  \n",
              "567  2018-06-30T00:00:00.000  \n",
              "568  2018-06-30T00:00:00.000  \n",
              "569  2018-06-30T00:00:00.000  \n",
              "\n",
              "[95 rows x 18 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-b424d704-7035-4e54-bc9d-88fcc6afafad\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>provider_id</th>\n",
              "      <th>hospital_name</th>\n",
              "      <th>address</th>\n",
              "      <th>city</th>\n",
              "      <th>state</th>\n",
              "      <th>zip_code</th>\n",
              "      <th>county_name</th>\n",
              "      <th>phone_number</th>\n",
              "      <th>measure_id</th>\n",
              "      <th>measure_name</th>\n",
              "      <th>compared_to_national</th>\n",
              "      <th>denominator</th>\n",
              "      <th>score</th>\n",
              "      <th>lower_estimate</th>\n",
              "      <th>higher_estimate</th>\n",
              "      <th>footnote</th>\n",
              "      <th>measure_start_date</th>\n",
              "      <th>measure_end_date</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>95</th>\n",
              "      <td>10011</td>\n",
              "      <td>ST VINCENT'S EAST</td>\n",
              "      <td>50 MEDICAL PARK EAST DRIVE</td>\n",
              "      <td>BIRMINGHAM</td>\n",
              "      <td>AL</td>\n",
              "      <td>35235</td>\n",
              "      <td>JEFFERSON</td>\n",
              "      <td>(205) 838-3122</td>\n",
              "      <td>COMP_HIP_KNEE</td>\n",
              "      <td>Rate of complications for hip/knee replacement...</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>107</td>\n",
              "      <td>2.9</td>\n",
              "      <td>1.7</td>\n",
              "      <td>4.7</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-04-01T00:00:00.000</td>\n",
              "      <td>2018-03-31T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>96</th>\n",
              "      <td>10011</td>\n",
              "      <td>ST VINCENT'S EAST</td>\n",
              "      <td>50 MEDICAL PARK EAST DRIVE</td>\n",
              "      <td>BIRMINGHAM</td>\n",
              "      <td>AL</td>\n",
              "      <td>35235</td>\n",
              "      <td>JEFFERSON</td>\n",
              "      <td>(205) 838-3122</td>\n",
              "      <td>MORT_30_AMI</td>\n",
              "      <td>Death rate for heart attack patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>170</td>\n",
              "      <td>14.8</td>\n",
              "      <td>11.7</td>\n",
              "      <td>18.4</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>97</th>\n",
              "      <td>10011</td>\n",
              "      <td>ST VINCENT'S EAST</td>\n",
              "      <td>50 MEDICAL PARK EAST DRIVE</td>\n",
              "      <td>BIRMINGHAM</td>\n",
              "      <td>AL</td>\n",
              "      <td>35235</td>\n",
              "      <td>JEFFERSON</td>\n",
              "      <td>(205) 838-3122</td>\n",
              "      <td>MORT_30_CABG</td>\n",
              "      <td>Death rate for CABG surgery patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>103</td>\n",
              "      <td>3</td>\n",
              "      <td>1.6</td>\n",
              "      <td>5.3</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>98</th>\n",
              "      <td>10011</td>\n",
              "      <td>ST VINCENT'S EAST</td>\n",
              "      <td>50 MEDICAL PARK EAST DRIVE</td>\n",
              "      <td>BIRMINGHAM</td>\n",
              "      <td>AL</td>\n",
              "      <td>35235</td>\n",
              "      <td>JEFFERSON</td>\n",
              "      <td>(205) 838-3122</td>\n",
              "      <td>MORT_30_COPD</td>\n",
              "      <td>Death rate for COPD patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>257</td>\n",
              "      <td>10.5</td>\n",
              "      <td>8.0</td>\n",
              "      <td>13.6</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>99</th>\n",
              "      <td>10011</td>\n",
              "      <td>ST VINCENT'S EAST</td>\n",
              "      <td>50 MEDICAL PARK EAST DRIVE</td>\n",
              "      <td>BIRMINGHAM</td>\n",
              "      <td>AL</td>\n",
              "      <td>35235</td>\n",
              "      <td>JEFFERSON</td>\n",
              "      <td>(205) 838-3122</td>\n",
              "      <td>MORT_30_HF</td>\n",
              "      <td>Death rate for heart failure patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>400</td>\n",
              "      <td>11.3</td>\n",
              "      <td>9.0</td>\n",
              "      <td>13.8</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>565</th>\n",
              "      <td>10056</td>\n",
              "      <td>ST VINCENT'S BIRMINGHAM</td>\n",
              "      <td>810 ST VINCENT'S DRIVE</td>\n",
              "      <td>BIRMINGHAM</td>\n",
              "      <td>AL</td>\n",
              "      <td>35205</td>\n",
              "      <td>JEFFERSON</td>\n",
              "      <td>(205) 939-7000</td>\n",
              "      <td>PSI_4_SURG_COMP</td>\n",
              "      <td>Deaths among Patients with Serious Treatable C...</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>153</td>\n",
              "      <td>161.36</td>\n",
              "      <td>123.41</td>\n",
              "      <td>199.31</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2016-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>566</th>\n",
              "      <td>10056</td>\n",
              "      <td>ST VINCENT'S BIRMINGHAM</td>\n",
              "      <td>810 ST VINCENT'S DRIVE</td>\n",
              "      <td>BIRMINGHAM</td>\n",
              "      <td>AL</td>\n",
              "      <td>35205</td>\n",
              "      <td>JEFFERSON</td>\n",
              "      <td>(205) 939-7000</td>\n",
              "      <td>PSI_6_IAT_PTX</td>\n",
              "      <td>Collapsed lung due to medical treatment</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>10106</td>\n",
              "      <td>0.26</td>\n",
              "      <td>0.07</td>\n",
              "      <td>0.46</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2016-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>567</th>\n",
              "      <td>10056</td>\n",
              "      <td>ST VINCENT'S BIRMINGHAM</td>\n",
              "      <td>810 ST VINCENT'S DRIVE</td>\n",
              "      <td>BIRMINGHAM</td>\n",
              "      <td>AL</td>\n",
              "      <td>35205</td>\n",
              "      <td>JEFFERSON</td>\n",
              "      <td>(205) 939-7000</td>\n",
              "      <td>PSI_8_POST_HIP</td>\n",
              "      <td>Broken hip from a fall after surgery</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>9282</td>\n",
              "      <td>0.11</td>\n",
              "      <td>0.02</td>\n",
              "      <td>0.19</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2016-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>568</th>\n",
              "      <td>10056</td>\n",
              "      <td>ST VINCENT'S BIRMINGHAM</td>\n",
              "      <td>810 ST VINCENT'S DRIVE</td>\n",
              "      <td>BIRMINGHAM</td>\n",
              "      <td>AL</td>\n",
              "      <td>35205</td>\n",
              "      <td>JEFFERSON</td>\n",
              "      <td>(205) 939-7000</td>\n",
              "      <td>PSI_90_SAFETY</td>\n",
              "      <td>Serious complications</td>\n",
              "      <td>No Different Than the National Value</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>0.98</td>\n",
              "      <td>0.77</td>\n",
              "      <td>1.2</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2016-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>569</th>\n",
              "      <td>10056</td>\n",
              "      <td>ST VINCENT'S BIRMINGHAM</td>\n",
              "      <td>810 ST VINCENT'S DRIVE</td>\n",
              "      <td>BIRMINGHAM</td>\n",
              "      <td>AL</td>\n",
              "      <td>35205</td>\n",
              "      <td>JEFFERSON</td>\n",
              "      <td>(205) 939-7000</td>\n",
              "      <td>PSI_9_POST_HEM</td>\n",
              "      <td>Perioperative Hemorrhage or Hematoma Rate</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>4662</td>\n",
              "      <td>2.42</td>\n",
              "      <td>1.31</td>\n",
              "      <td>3.54</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2016-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>95 rows  18 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b424d704-7035-4e54-bc9d-88fcc6afafad')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-b424d704-7035-4e54-bc9d-88fcc6afafad button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-b424d704-7035-4e54-bc9d-88fcc6afafad');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-fc5861a8-520f-47b5-a722-73bed4071115\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-fc5861a8-520f-47b5-a722-73bed4071115')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-fc5861a8-520f-47b5-a722-73bed4071115 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 4
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "vlN9dc5JdnBa"
      },
      "outputs": [],
      "source": [
        "data.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "ouCkMhufdnBa",
        "outputId": "c4895cef-7e2b-4734-d806-571ca2011890",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 417
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "     provider_id                   hospital_name             address  \\\n",
              "513        10052  LAKE MARTIN COMMUNITY HOSPITAL  201 MARIARDEN ROAD   \n",
              "514        10052  LAKE MARTIN COMMUNITY HOSPITAL  201 MARIARDEN ROAD   \n",
              "515        10052  LAKE MARTIN COMMUNITY HOSPITAL  201 MARIARDEN ROAD   \n",
              "516        10052  LAKE MARTIN COMMUNITY HOSPITAL  201 MARIARDEN ROAD   \n",
              "517        10052  LAKE MARTIN COMMUNITY HOSPITAL  201 MARIARDEN ROAD   \n",
              "\n",
              "          city state  zip_code county_name    phone_number     measure_id  \\\n",
              "513  DADEVILLE    AL     36853  TALLAPOOSA  (256) 825-7821  COMP_HIP_KNEE   \n",
              "514  DADEVILLE    AL     36853  TALLAPOOSA  (256) 825-7821    MORT_30_AMI   \n",
              "515  DADEVILLE    AL     36853  TALLAPOOSA  (256) 825-7821   MORT_30_CABG   \n",
              "516  DADEVILLE    AL     36853  TALLAPOOSA  (256) 825-7821   MORT_30_COPD   \n",
              "517  DADEVILLE    AL     36853  TALLAPOOSA  (256) 825-7821     MORT_30_HF   \n",
              "\n",
              "                                          measure_name  \\\n",
              "513  Rate of complications for hip/knee replacement...   \n",
              "514               Death rate for heart attack patients   \n",
              "515               Death rate for CABG surgery patients   \n",
              "516                       Death rate for COPD patients   \n",
              "517              Death rate for heart failure patients   \n",
              "\n",
              "                    compared_to_national    denominator          score  \\\n",
              "513                        Not Available  Not Available  Not Available   \n",
              "514            Number of Cases Too Small  Not Available  Not Available   \n",
              "515                        Not Available  Not Available  Not Available   \n",
              "516  No Different Than the National Rate             65            8.1   \n",
              "517            Number of Cases Too Small  Not Available  Not Available   \n",
              "\n",
              "    lower_estimate higher_estimate  footnote       measure_start_date  \\\n",
              "513  Not Available   Not Available       5.0  2015-04-01T00:00:00.000   \n",
              "514  Not Available   Not Available       1.0  2015-07-01T00:00:00.000   \n",
              "515  Not Available   Not Available       5.0  2015-07-01T00:00:00.000   \n",
              "516            5.5            11.7       NaN  2015-07-01T00:00:00.000   \n",
              "517  Not Available   Not Available       1.0  2015-07-01T00:00:00.000   \n",
              "\n",
              "            measure_end_date  \n",
              "513  2018-03-31T00:00:00.000  \n",
              "514  2018-06-30T00:00:00.000  \n",
              "515  2018-06-30T00:00:00.000  \n",
              "516  2018-06-30T00:00:00.000  \n",
              "517  2018-06-30T00:00:00.000  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-8f9511ca-6113-472e-8611-f781d9dc90be\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>provider_id</th>\n",
              "      <th>hospital_name</th>\n",
              "      <th>address</th>\n",
              "      <th>city</th>\n",
              "      <th>state</th>\n",
              "      <th>zip_code</th>\n",
              "      <th>county_name</th>\n",
              "      <th>phone_number</th>\n",
              "      <th>measure_id</th>\n",
              "      <th>measure_name</th>\n",
              "      <th>compared_to_national</th>\n",
              "      <th>denominator</th>\n",
              "      <th>score</th>\n",
              "      <th>lower_estimate</th>\n",
              "      <th>higher_estimate</th>\n",
              "      <th>footnote</th>\n",
              "      <th>measure_start_date</th>\n",
              "      <th>measure_end_date</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>513</th>\n",
              "      <td>10052</td>\n",
              "      <td>LAKE MARTIN COMMUNITY HOSPITAL</td>\n",
              "      <td>201 MARIARDEN ROAD</td>\n",
              "      <td>DADEVILLE</td>\n",
              "      <td>AL</td>\n",
              "      <td>36853</td>\n",
              "      <td>TALLAPOOSA</td>\n",
              "      <td>(256) 825-7821</td>\n",
              "      <td>COMP_HIP_KNEE</td>\n",
              "      <td>Rate of complications for hip/knee replacement...</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>5.0</td>\n",
              "      <td>2015-04-01T00:00:00.000</td>\n",
              "      <td>2018-03-31T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>514</th>\n",
              "      <td>10052</td>\n",
              "      <td>LAKE MARTIN COMMUNITY HOSPITAL</td>\n",
              "      <td>201 MARIARDEN ROAD</td>\n",
              "      <td>DADEVILLE</td>\n",
              "      <td>AL</td>\n",
              "      <td>36853</td>\n",
              "      <td>TALLAPOOSA</td>\n",
              "      <td>(256) 825-7821</td>\n",
              "      <td>MORT_30_AMI</td>\n",
              "      <td>Death rate for heart attack patients</td>\n",
              "      <td>Number of Cases Too Small</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>1.0</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>515</th>\n",
              "      <td>10052</td>\n",
              "      <td>LAKE MARTIN COMMUNITY HOSPITAL</td>\n",
              "      <td>201 MARIARDEN ROAD</td>\n",
              "      <td>DADEVILLE</td>\n",
              "      <td>AL</td>\n",
              "      <td>36853</td>\n",
              "      <td>TALLAPOOSA</td>\n",
              "      <td>(256) 825-7821</td>\n",
              "      <td>MORT_30_CABG</td>\n",
              "      <td>Death rate for CABG surgery patients</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>5.0</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>516</th>\n",
              "      <td>10052</td>\n",
              "      <td>LAKE MARTIN COMMUNITY HOSPITAL</td>\n",
              "      <td>201 MARIARDEN ROAD</td>\n",
              "      <td>DADEVILLE</td>\n",
              "      <td>AL</td>\n",
              "      <td>36853</td>\n",
              "      <td>TALLAPOOSA</td>\n",
              "      <td>(256) 825-7821</td>\n",
              "      <td>MORT_30_COPD</td>\n",
              "      <td>Death rate for COPD patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>65</td>\n",
              "      <td>8.1</td>\n",
              "      <td>5.5</td>\n",
              "      <td>11.7</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>517</th>\n",
              "      <td>10052</td>\n",
              "      <td>LAKE MARTIN COMMUNITY HOSPITAL</td>\n",
              "      <td>201 MARIARDEN ROAD</td>\n",
              "      <td>DADEVILLE</td>\n",
              "      <td>AL</td>\n",
              "      <td>36853</td>\n",
              "      <td>TALLAPOOSA</td>\n",
              "      <td>(256) 825-7821</td>\n",
              "      <td>MORT_30_HF</td>\n",
              "      <td>Death rate for heart failure patients</td>\n",
              "      <td>Number of Cases Too Small</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>Not Available</td>\n",
              "      <td>1.0</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8f9511ca-6113-472e-8611-f781d9dc90be')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-8f9511ca-6113-472e-8611-f781d9dc90be button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-8f9511ca-6113-472e-8611-f781d9dc90be');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-b7bbe7f1-0e86-48ce-bcf8-06d8c1955f62\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-b7bbe7f1-0e86-48ce-bcf8-06d8c1955f62')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-b7bbe7f1-0e86-48ce-bcf8-06d8c1955f62 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 15
        }
      ],
      "source": [
        "#Here we have created a query where the city is Dadeville and the state is alabame. This is a filter in its own.\n",
        "data.query('city == \"DADEVILLE\" and state == \"AL\"').head()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "UctDf4fZdnBa"
      },
      "source": [
        "# Generic Complex Filtering\n",
        "\n",
        "Apply some generic function to an entire row to figure out if should be filtered."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 5,
      "metadata": {
        "id": "gxjyPTlxdnBa"
      },
      "outputs": [],
      "source": [
        "#So we create a data set where for the score column we are not getting rows where the value is 'Not Available'.\n",
        "#The same can be sade for the denominator column as we will not get values that are not available.\n",
        "#This created a data set by filtering and it was very consise I feel.\n",
        "with_score = data[(data['score'] != 'Not Available') & (data['denominator'] != 'Not Available')]"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 6,
      "metadata": {
        "id": "2ieJuj_sdnBa",
        "outputId": "0f054b97-9bd1-4948-afbf-ea212d3ad42a",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "(691, 18)"
            ]
          },
          "metadata": {},
          "execution_count": 6
        }
      ],
      "source": [
        "with_score.shape"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 7,
      "metadata": {
        "id": "BVx1P93WdnBb",
        "outputId": "80ae1a35-081b-4310-ec4b-299b168c52ad",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stderr",
          "text": [
            "<ipython-input-7-a2477d95ee33>:1: SettingWithCopyWarning: \n",
            "A value is trying to be set on a copy of a slice from a DataFrame.\n",
            "Try using .loc[row_indexer,col_indexer] = value instead\n",
            "\n",
            "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
            "  with_score['pct'] = with_score['score'].astype(float) / with_score['denominator'].astype(float)\n"
          ]
        }
      ],
      "source": [
        "#We create a new column that is the score divided by the denominator.\n",
        "with_score['pct'] = with_score['score'].astype(float) / with_score['denominator'].astype(float)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 8,
      "metadata": {
        "id": "m_iw68LxdnBb",
        "outputId": "568c59db-6022-4bef-8bb7-1adab3b68838",
        "colab": {
          "base_uri": "https://localhost:8080/"
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "4.228329809725158e-06"
            ]
          },
          "metadata": {},
          "execution_count": 8
        }
      ],
      "source": [
        "with_score['pct'].min()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "qPIMV-EUdnBb"
      },
      "outputs": [],
      "source": [
        "with_score['pct'].max()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "QKUgbJYNdnBb"
      },
      "outputs": [],
      "source": [
        "too_high = with_score['pct'] > 1\n",
        "with_score[too_high]"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 10,
      "metadata": {
        "id": "Wuyono6DdnBb"
      },
      "outputs": [],
      "source": [
        "#We are creating a data set where the only rows that are returned have the value found by dividing their score by their denominator is greater than 0.10.\n",
        "mask = with_score.apply(lambda x: (float(x['score']) / float(x['denominator'])) > 0.10, axis=1)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 11,
      "metadata": {
        "id": "VpL2tuIgdnBb",
        "outputId": "5045649e-9bf6-40d1-8b6f-7939c6c05269",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 964
        }
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "     provider_id                          hospital_name  \\\n",
              "14         10001       SOUTHEAST ALABAMA MEDICAL CENTER   \n",
              "20         10005  MARSHALL MEDICAL CENTERS SOUTH CAMPUS   \n",
              "33         10005  MARSHALL MEDICAL CENTERS SOUTH CAMPUS   \n",
              "52         10006           NORTH ALABAMA MEDICAL CENTER   \n",
              "61         10007               MIZELL MEMORIAL HOSPITAL   \n",
              "..           ...                                    ...   \n",
              "972        10101        CITIZENS BAPTIST MEDICAL CENTER   \n",
              "973        10101        CITIZENS BAPTIST MEDICAL CENTER   \n",
              "974        10101        CITIZENS BAPTIST MEDICAL CENTER   \n",
              "975        10101        CITIZENS BAPTIST MEDICAL CENTER   \n",
              "993        10102                  J PAUL JONES HOSPITAL   \n",
              "\n",
              "                        address       city state  zip_code county_name  \\\n",
              "14       1108 ROSS CLARK CIRCLE     DOTHAN    AL     36301     HOUSTON   \n",
              "20   2505 U S HIGHWAY 431 NORTH       BOAZ    AL     35957    MARSHALL   \n",
              "33   2505 U S HIGHWAY 431 NORTH       BOAZ    AL     35957    MARSHALL   \n",
              "52          1701 VETERANS DRIVE   FLORENCE    AL     35630  LAUDERDALE   \n",
              "61                702 N MAIN ST        OPP    AL     36467   COVINGTON   \n",
              "..                          ...        ...   ...       ...         ...   \n",
              "972            604 STONE AVENUE  TALLADEGA    AL     35161   TALLADEGA   \n",
              "973            604 STONE AVENUE  TALLADEGA    AL     35161   TALLADEGA   \n",
              "974            604 STONE AVENUE  TALLADEGA    AL     35161   TALLADEGA   \n",
              "975            604 STONE AVENUE  TALLADEGA    AL     35161   TALLADEGA   \n",
              "993       317 MCWILLIAMS AVENUE     CAMDEN    AL     36726      WILCOX   \n",
              "\n",
              "       phone_number       measure_id  \\\n",
              "14   (334) 793-8701  PSI_4_SURG_COMP   \n",
              "20   (256) 593-8310      MORT_30_AMI   \n",
              "33   (256) 593-8310  PSI_4_SURG_COMP   \n",
              "52   (256) 768-8400  PSI_4_SURG_COMP   \n",
              "61   (334) 493-3541       MORT_30_HF   \n",
              "..              ...              ...   \n",
              "972  (256) 761-4542     MORT_30_COPD   \n",
              "973  (256) 761-4542       MORT_30_HF   \n",
              "974  (256) 761-4542       MORT_30_PN   \n",
              "975  (256) 761-4542      MORT_30_STK   \n",
              "993  (334) 682-4131       MORT_30_PN   \n",
              "\n",
              "                                          measure_name  \\\n",
              "14   Deaths among Patients with Serious Treatable C...   \n",
              "20                Death rate for heart attack patients   \n",
              "33   Deaths among Patients with Serious Treatable C...   \n",
              "52   Deaths among Patients with Serious Treatable C...   \n",
              "61               Death rate for heart failure patients   \n",
              "..                                                 ...   \n",
              "972                       Death rate for COPD patients   \n",
              "973              Death rate for heart failure patients   \n",
              "974                  Death rate for pneumonia patients   \n",
              "975                     Death rate for stroke patients   \n",
              "993                  Death rate for pneumonia patients   \n",
              "\n",
              "                    compared_to_national denominator   score lower_estimate  \\\n",
              "14   No Different Than the National Rate         185  163.11          127.1   \n",
              "20   No Different Than the National Rate          80    14.8           11.6   \n",
              "33          Worse Than the National Rate          54  219.04         170.43   \n",
              "52          Worse Than the National Rate         114  207.61         166.63   \n",
              "61   No Different Than the National Rate          85    15.6           11.1   \n",
              "..                                   ...         ...     ...            ...   \n",
              "972  No Different Than the National Rate          79     9.6            6.5   \n",
              "973  No Different Than the National Rate          78    11.7            8.0   \n",
              "974  No Different Than the National Rate          89    18.7           14.1   \n",
              "975  No Different Than the National Rate          33    14.3           10.5   \n",
              "993  No Different Than the National Rate          29    18.2           12.9   \n",
              "\n",
              "    higher_estimate  footnote       measure_start_date  \\\n",
              "14           199.11       NaN  2016-07-01T00:00:00.000   \n",
              "20             18.8       NaN  2015-07-01T00:00:00.000   \n",
              "33           267.66       NaN  2016-07-01T00:00:00.000   \n",
              "52            248.6       NaN  2016-07-01T00:00:00.000   \n",
              "61             21.7       NaN  2015-07-01T00:00:00.000   \n",
              "..              ...       ...                      ...   \n",
              "972            13.8       NaN  2015-07-01T00:00:00.000   \n",
              "973            16.4       NaN  2015-07-01T00:00:00.000   \n",
              "974            24.7       NaN  2015-07-01T00:00:00.000   \n",
              "975            19.4       NaN  2015-07-01T00:00:00.000   \n",
              "993            24.9       NaN  2015-07-01T00:00:00.000   \n",
              "\n",
              "            measure_end_date       pct  \n",
              "14   2018-06-30T00:00:00.000  0.881676  \n",
              "20   2018-06-30T00:00:00.000  0.185000  \n",
              "33   2018-06-30T00:00:00.000  4.056296  \n",
              "52   2018-06-30T00:00:00.000  1.821140  \n",
              "61   2018-06-30T00:00:00.000  0.183529  \n",
              "..                       ...       ...  \n",
              "972  2018-06-30T00:00:00.000  0.121519  \n",
              "973  2018-06-30T00:00:00.000  0.150000  \n",
              "974  2018-06-30T00:00:00.000  0.210112  \n",
              "975  2018-06-30T00:00:00.000  0.433333  \n",
              "993  2018-06-30T00:00:00.000  0.627586  \n",
              "\n",
              "[113 rows x 19 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-7a5f8fe6-e259-4acd-8f2a-9a9b8e171307\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>provider_id</th>\n",
              "      <th>hospital_name</th>\n",
              "      <th>address</th>\n",
              "      <th>city</th>\n",
              "      <th>state</th>\n",
              "      <th>zip_code</th>\n",
              "      <th>county_name</th>\n",
              "      <th>phone_number</th>\n",
              "      <th>measure_id</th>\n",
              "      <th>measure_name</th>\n",
              "      <th>compared_to_national</th>\n",
              "      <th>denominator</th>\n",
              "      <th>score</th>\n",
              "      <th>lower_estimate</th>\n",
              "      <th>higher_estimate</th>\n",
              "      <th>footnote</th>\n",
              "      <th>measure_start_date</th>\n",
              "      <th>measure_end_date</th>\n",
              "      <th>pct</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>14</th>\n",
              "      <td>10001</td>\n",
              "      <td>SOUTHEAST ALABAMA MEDICAL CENTER</td>\n",
              "      <td>1108 ROSS CLARK CIRCLE</td>\n",
              "      <td>DOTHAN</td>\n",
              "      <td>AL</td>\n",
              "      <td>36301</td>\n",
              "      <td>HOUSTON</td>\n",
              "      <td>(334) 793-8701</td>\n",
              "      <td>PSI_4_SURG_COMP</td>\n",
              "      <td>Deaths among Patients with Serious Treatable C...</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>185</td>\n",
              "      <td>163.11</td>\n",
              "      <td>127.1</td>\n",
              "      <td>199.11</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2016-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "      <td>0.881676</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>20</th>\n",
              "      <td>10005</td>\n",
              "      <td>MARSHALL MEDICAL CENTERS SOUTH CAMPUS</td>\n",
              "      <td>2505 U S HIGHWAY 431 NORTH</td>\n",
              "      <td>BOAZ</td>\n",
              "      <td>AL</td>\n",
              "      <td>35957</td>\n",
              "      <td>MARSHALL</td>\n",
              "      <td>(256) 593-8310</td>\n",
              "      <td>MORT_30_AMI</td>\n",
              "      <td>Death rate for heart attack patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>80</td>\n",
              "      <td>14.8</td>\n",
              "      <td>11.6</td>\n",
              "      <td>18.8</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "      <td>0.185000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>33</th>\n",
              "      <td>10005</td>\n",
              "      <td>MARSHALL MEDICAL CENTERS SOUTH CAMPUS</td>\n",
              "      <td>2505 U S HIGHWAY 431 NORTH</td>\n",
              "      <td>BOAZ</td>\n",
              "      <td>AL</td>\n",
              "      <td>35957</td>\n",
              "      <td>MARSHALL</td>\n",
              "      <td>(256) 593-8310</td>\n",
              "      <td>PSI_4_SURG_COMP</td>\n",
              "      <td>Deaths among Patients with Serious Treatable C...</td>\n",
              "      <td>Worse Than the National Rate</td>\n",
              "      <td>54</td>\n",
              "      <td>219.04</td>\n",
              "      <td>170.43</td>\n",
              "      <td>267.66</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2016-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "      <td>4.056296</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>52</th>\n",
              "      <td>10006</td>\n",
              "      <td>NORTH ALABAMA MEDICAL CENTER</td>\n",
              "      <td>1701 VETERANS DRIVE</td>\n",
              "      <td>FLORENCE</td>\n",
              "      <td>AL</td>\n",
              "      <td>35630</td>\n",
              "      <td>LAUDERDALE</td>\n",
              "      <td>(256) 768-8400</td>\n",
              "      <td>PSI_4_SURG_COMP</td>\n",
              "      <td>Deaths among Patients with Serious Treatable C...</td>\n",
              "      <td>Worse Than the National Rate</td>\n",
              "      <td>114</td>\n",
              "      <td>207.61</td>\n",
              "      <td>166.63</td>\n",
              "      <td>248.6</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2016-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "      <td>1.821140</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>61</th>\n",
              "      <td>10007</td>\n",
              "      <td>MIZELL MEMORIAL HOSPITAL</td>\n",
              "      <td>702 N MAIN ST</td>\n",
              "      <td>OPP</td>\n",
              "      <td>AL</td>\n",
              "      <td>36467</td>\n",
              "      <td>COVINGTON</td>\n",
              "      <td>(334) 493-3541</td>\n",
              "      <td>MORT_30_HF</td>\n",
              "      <td>Death rate for heart failure patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>85</td>\n",
              "      <td>15.6</td>\n",
              "      <td>11.1</td>\n",
              "      <td>21.7</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "      <td>0.183529</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>972</th>\n",
              "      <td>10101</td>\n",
              "      <td>CITIZENS BAPTIST MEDICAL CENTER</td>\n",
              "      <td>604 STONE AVENUE</td>\n",
              "      <td>TALLADEGA</td>\n",
              "      <td>AL</td>\n",
              "      <td>35161</td>\n",
              "      <td>TALLADEGA</td>\n",
              "      <td>(256) 761-4542</td>\n",
              "      <td>MORT_30_COPD</td>\n",
              "      <td>Death rate for COPD patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>79</td>\n",
              "      <td>9.6</td>\n",
              "      <td>6.5</td>\n",
              "      <td>13.8</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "      <td>0.121519</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>973</th>\n",
              "      <td>10101</td>\n",
              "      <td>CITIZENS BAPTIST MEDICAL CENTER</td>\n",
              "      <td>604 STONE AVENUE</td>\n",
              "      <td>TALLADEGA</td>\n",
              "      <td>AL</td>\n",
              "      <td>35161</td>\n",
              "      <td>TALLADEGA</td>\n",
              "      <td>(256) 761-4542</td>\n",
              "      <td>MORT_30_HF</td>\n",
              "      <td>Death rate for heart failure patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>78</td>\n",
              "      <td>11.7</td>\n",
              "      <td>8.0</td>\n",
              "      <td>16.4</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "      <td>0.150000</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>974</th>\n",
              "      <td>10101</td>\n",
              "      <td>CITIZENS BAPTIST MEDICAL CENTER</td>\n",
              "      <td>604 STONE AVENUE</td>\n",
              "      <td>TALLADEGA</td>\n",
              "      <td>AL</td>\n",
              "      <td>35161</td>\n",
              "      <td>TALLADEGA</td>\n",
              "      <td>(256) 761-4542</td>\n",
              "      <td>MORT_30_PN</td>\n",
              "      <td>Death rate for pneumonia patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>89</td>\n",
              "      <td>18.7</td>\n",
              "      <td>14.1</td>\n",
              "      <td>24.7</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "      <td>0.210112</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>975</th>\n",
              "      <td>10101</td>\n",
              "      <td>CITIZENS BAPTIST MEDICAL CENTER</td>\n",
              "      <td>604 STONE AVENUE</td>\n",
              "      <td>TALLADEGA</td>\n",
              "      <td>AL</td>\n",
              "      <td>35161</td>\n",
              "      <td>TALLADEGA</td>\n",
              "      <td>(256) 761-4542</td>\n",
              "      <td>MORT_30_STK</td>\n",
              "      <td>Death rate for stroke patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>33</td>\n",
              "      <td>14.3</td>\n",
              "      <td>10.5</td>\n",
              "      <td>19.4</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "      <td>0.433333</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>993</th>\n",
              "      <td>10102</td>\n",
              "      <td>J PAUL JONES HOSPITAL</td>\n",
              "      <td>317 MCWILLIAMS AVENUE</td>\n",
              "      <td>CAMDEN</td>\n",
              "      <td>AL</td>\n",
              "      <td>36726</td>\n",
              "      <td>WILCOX</td>\n",
              "      <td>(334) 682-4131</td>\n",
              "      <td>MORT_30_PN</td>\n",
              "      <td>Death rate for pneumonia patients</td>\n",
              "      <td>No Different Than the National Rate</td>\n",
              "      <td>29</td>\n",
              "      <td>18.2</td>\n",
              "      <td>12.9</td>\n",
              "      <td>24.9</td>\n",
              "      <td>NaN</td>\n",
              "      <td>2015-07-01T00:00:00.000</td>\n",
              "      <td>2018-06-30T00:00:00.000</td>\n",
              "      <td>0.627586</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>113 rows  19 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7a5f8fe6-e259-4acd-8f2a-9a9b8e171307')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-7a5f8fe6-e259-4acd-8f2a-9a9b8e171307 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-7a5f8fe6-e259-4acd-8f2a-9a9b8e171307');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-8f906c36-c0c2-4952-9c8d-285e7e318bab\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-8f906c36-c0c2-4952-9c8d-285e7e318bab')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-8f906c36-c0c2-4952-9c8d-285e7e318bab button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "    </div>\n",
              "  </div>\n"
            ]
          },
          "metadata": {},
          "execution_count": 11
        }
      ],
      "source": [
        "with_score[mask]"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "_Xp0pWC2dnBb"
      },
      "outputs": [],
      "source": [
        "with_score.shape"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "YkGChHgHdnBc"
      },
      "outputs": [],
      "source": [
        "with_score[mask].shape"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "un8cFt8EdnBc"
      },
      "outputs": [],
      "source": [
        "with_score[mask].head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "_ElewXHydnBc"
      },
      "outputs": [],
      "source": []
    }
  ],
  "metadata": {
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.6.7"
    },
    "colab": {
      "provenance": [],
      "include_colab_link": true
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
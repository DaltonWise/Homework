{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/DaltonWise/Homework/blob/main/HDS%20Week%2011%3A%20Date%20Time\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [
        "**Date Time**\n",
        "\n",
        "This is a new data type.\n",
        "\n",
        "Creating a date time field:\n",
        "\n",
        "Use pandas.to_datetime(series, format). The format string uses the place holders. These are %m/%d/%Y and %Y-%m-%d. Notice how the year is the only one that is ever capitalized.\n",
        "\n",
        "Time between dates:\n",
        "\n",
        "When you subtract two datetime fields you get a time delta returned. You can change the precision of a time delta by dividing by another time delta.\n",
        "\n",
        "\n",
        "ndc['duration'] = (ndc['end'] - ndc['start'])\n",
        "\n",
        "\n",
        "Create a new column in ndc that is the start date subtracted from the end date.\n",
        "\n",
        "\n",
        "import numpy as np\n",
        "\n",
        "ndc['years'] = ndc.duration // np.timedelta64(1, 'Y')\n",
        "\n",
        "\n",
        "So we divided our time delta by another time delta and created a new column 'years'.\n",
        "\n",
        "Calculating New Dates:\n",
        "\n",
        "You can add or subtract a timedelta to a date to get a new date.\n",
        "\n",
        "pd.offset, pd.offsets.BDay()\n",
        "\n",
        "pd.offsets...\n",
        "\n",
        "Pandas allows you to make customized weekday, holiday, and work hours calenders. This supports business day/hour calculations.\n"
      ],
      "metadata": {
        "id": "9C8R3TdznjY5"
      }
    },
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "id": "DQUQYJngnhrG"
      },
      "outputs": [],
      "source": [
        "import pandas as pd\n",
        "import datetime"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 2,
      "metadata": {
        "id": "hLzfFiV7nhrL",
        "outputId": "056b1647-d44c-4022-f4de-f30befd0ba67",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 330
        }
      },
      "outputs": [
        {
          "output_type": "error",
          "ename": "FileNotFoundError",
          "evalue": "ignored",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mFileNotFoundError\u001b[0m                         Traceback (most recent call last)",
            "\u001b[0;32m<ipython-input-2-fb0fd1c2b0f2>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mndc\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread_csv\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'/data/product.txt'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mdelimiter\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'\\t'\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mstr\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m",
            "\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/util/_decorators.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    209\u001b[0m                 \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    210\u001b[0m                     \u001b[0mkwargs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mnew_arg_name\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnew_arg_value\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 211\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    212\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    213\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mcast\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mF\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mwrapper\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/util/_decorators.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    329\u001b[0m                     \u001b[0mstacklevel\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mfind_stack_level\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    330\u001b[0m                 )\n\u001b[0;32m--> 331\u001b[0;31m             \u001b[0;32mreturn\u001b[0m \u001b[0mfunc\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    332\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    333\u001b[0m         \u001b[0;31m# error: \"Callable[[VarArg(Any), KwArg(Any)], Any]\" has no\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/readers.py\u001b[0m in \u001b[0;36mread_csv\u001b[0;34m(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, error_bad_lines, warn_bad_lines, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)\u001b[0m\n\u001b[1;32m    948\u001b[0m     \u001b[0mkwds\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mupdate\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mkwds_defaults\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    949\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 950\u001b[0;31m     \u001b[0;32mreturn\u001b[0m \u001b[0m_read\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfilepath_or_buffer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mkwds\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    951\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    952\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/readers.py\u001b[0m in \u001b[0;36m_read\u001b[0;34m(filepath_or_buffer, kwds)\u001b[0m\n\u001b[1;32m    603\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    604\u001b[0m     \u001b[0;31m# Create the parser.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 605\u001b[0;31m     \u001b[0mparser\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mTextFileReader\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfilepath_or_buffer\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwds\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    606\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    607\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mchunksize\u001b[0m \u001b[0;32mor\u001b[0m \u001b[0miterator\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/readers.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, f, engine, **kwds)\u001b[0m\n\u001b[1;32m   1440\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1441\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhandles\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mIOHandles\u001b[0m \u001b[0;34m|\u001b[0m \u001b[0;32mNone\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1442\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_engine\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_make_engine\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mf\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mengine\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1443\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1444\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mclose\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m->\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/io/parsers/readers.py\u001b[0m in \u001b[0;36m_make_engine\u001b[0;34m(self, f, engine)\u001b[0m\n\u001b[1;32m   1733\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0;34m\"b\"\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mmode\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1734\u001b[0m                     \u001b[0mmode\u001b[0m \u001b[0;34m+=\u001b[0m \u001b[0;34m\"b\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1735\u001b[0;31m             self.handles = get_handle(\n\u001b[0m\u001b[1;32m   1736\u001b[0m                 \u001b[0mf\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1737\u001b[0m                 \u001b[0mmode\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;32m/usr/local/lib/python3.10/dist-packages/pandas/io/common.py\u001b[0m in \u001b[0;36mget_handle\u001b[0;34m(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)\u001b[0m\n\u001b[1;32m    854\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mioargs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mencoding\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0;34m\"b\"\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mioargs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmode\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    855\u001b[0m             \u001b[0;31m# Encoding\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 856\u001b[0;31m             handle = open(\n\u001b[0m\u001b[1;32m    857\u001b[0m                 \u001b[0mhandle\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    858\u001b[0m                 \u001b[0mioargs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmode\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
            "\u001b[0;31mFileNotFoundError\u001b[0m: [Errno 2] No such file or directory: '/data/product.txt'"
          ]
        }
      ],
      "source": [
        "ndc = pd.read_csv('/data/product.txt',delimiter='\\t',dtype=str)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "qk1PKXZvnhrM",
        "outputId": "50cb4fae-f18f-4c67-ad6b-1b12181d49bb"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>PRODUCTID</th>\n",
              "      <th>PRODUCTNDC</th>\n",
              "      <th>PRODUCTTYPENAME</th>\n",
              "      <th>PROPRIETARYNAME</th>\n",
              "      <th>PROPRIETARYNAMESUFFIX</th>\n",
              "      <th>NONPROPRIETARYNAME</th>\n",
              "      <th>DOSAGEFORMNAME</th>\n",
              "      <th>ROUTENAME</th>\n",
              "      <th>STARTMARKETINGDATE</th>\n",
              "      <th>ENDMARKETINGDATE</th>\n",
              "      <th>MARKETINGCATEGORYNAME</th>\n",
              "      <th>APPLICATIONNUMBER</th>\n",
              "      <th>LABELERNAME</th>\n",
              "      <th>SUBSTANCENAME</th>\n",
              "      <th>ACTIVE_NUMERATOR_STRENGTH</th>\n",
              "      <th>ACTIVE_INGRED_UNIT</th>\n",
              "      <th>PHARM_CLASSES</th>\n",
              "      <th>DEASCHEDULE</th>\n",
              "      <th>NDC_EXCLUDE_FLAG</th>\n",
              "      <th>LISTING_RECORD_CERTIFIED_THROUGH</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0002-0800_4bb5d1cb-0fa7-48c7-9f6d-8d45f9b91649</td>\n",
              "      <td>0002-0800</td>\n",
              "      <td>HUMAN OTC DRUG</td>\n",
              "      <td>Sterile Diluent</td>\n",
              "      <td>NaN</td>\n",
              "      <td>diluent</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>19870710</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NDA</td>\n",
              "      <td>NDA018781</td>\n",
              "      <td>Eli Lilly and Company</td>\n",
              "      <td>WATER</td>\n",
              "      <td>1</td>\n",
              "      <td>mL/mL</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0002-1200_957ee1b5-dfa7-4e3f-96e1-6bed1ffc0abe</td>\n",
              "      <td>0002-1200</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Amyvid</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Florbetapir F 18</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>INTRAVENOUS</td>\n",
              "      <td>20120601</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NDA</td>\n",
              "      <td>NDA202008</td>\n",
              "      <td>Eli Lilly and Company</td>\n",
              "      <td>FLORBETAPIR F-18</td>\n",
              "      <td>51</td>\n",
              "      <td>mCi/mL</td>\n",
              "      <td>Radioactive Diagnostic Agent [EPC],Positron Em...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0002-1407_14757f9d-f641-4836-acf3-229265588d1d</td>\n",
              "      <td>0002-1407</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Quinidine Gluconate</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Quinidine Gluconate</td>\n",
              "      <td>SOLUTION</td>\n",
              "      <td>INTRAVENOUS</td>\n",
              "      <td>19500712</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NDA</td>\n",
              "      <td>NDA007529</td>\n",
              "      <td>Eli Lilly and Company</td>\n",
              "      <td>QUINIDINE GLUCONATE</td>\n",
              "      <td>80</td>\n",
              "      <td>mg/mL</td>\n",
              "      <td>Antiarrhythmic [EPC],Cytochrome P450 2D6 Inhib...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0002-1433_4468578a-47d2-488e-9fd4-a8322070392f</td>\n",
              "      <td>0002-1433</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Trulicity</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Dulaglutide</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>20140918</td>\n",
              "      <td>NaN</td>\n",
              "      <td>BLA</td>\n",
              "      <td>BLA125469</td>\n",
              "      <td>Eli Lilly and Company</td>\n",
              "      <td>DULAGLUTIDE</td>\n",
              "      <td>.75</td>\n",
              "      <td>mg/.5mL</td>\n",
              "      <td>GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0002-1434_4468578a-47d2-488e-9fd4-a8322070392f</td>\n",
              "      <td>0002-1434</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Trulicity</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Dulaglutide</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>20140918</td>\n",
              "      <td>NaN</td>\n",
              "      <td>BLA</td>\n",
              "      <td>BLA125469</td>\n",
              "      <td>Eli Lilly and Company</td>\n",
              "      <td>DULAGLUTIDE</td>\n",
              "      <td>1.5</td>\n",
              "      <td>mg/.5mL</td>\n",
              "      <td>GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>"
            ],
            "text/plain": [
              "                                        PRODUCTID PRODUCTNDC  \\\n",
              "0  0002-0800_4bb5d1cb-0fa7-48c7-9f6d-8d45f9b91649  0002-0800   \n",
              "1  0002-1200_957ee1b5-dfa7-4e3f-96e1-6bed1ffc0abe  0002-1200   \n",
              "2  0002-1407_14757f9d-f641-4836-acf3-229265588d1d  0002-1407   \n",
              "3  0002-1433_4468578a-47d2-488e-9fd4-a8322070392f  0002-1433   \n",
              "4  0002-1434_4468578a-47d2-488e-9fd4-a8322070392f  0002-1434   \n",
              "\n",
              "           PRODUCTTYPENAME      PROPRIETARYNAME PROPRIETARYNAMESUFFIX  \\\n",
              "0           HUMAN OTC DRUG      Sterile Diluent                   NaN   \n",
              "1  HUMAN PRESCRIPTION DRUG               Amyvid                   NaN   \n",
              "2  HUMAN PRESCRIPTION DRUG  Quinidine Gluconate                   NaN   \n",
              "3  HUMAN PRESCRIPTION DRUG            Trulicity                   NaN   \n",
              "4  HUMAN PRESCRIPTION DRUG            Trulicity                   NaN   \n",
              "\n",
              "    NONPROPRIETARYNAME       DOSAGEFORMNAME     ROUTENAME STARTMARKETINGDATE  \\\n",
              "0              diluent  INJECTION, SOLUTION  SUBCUTANEOUS           19870710   \n",
              "1     Florbetapir F 18  INJECTION, SOLUTION   INTRAVENOUS           20120601   \n",
              "2  Quinidine Gluconate             SOLUTION   INTRAVENOUS           19500712   \n",
              "3          Dulaglutide  INJECTION, SOLUTION  SUBCUTANEOUS           20140918   \n",
              "4          Dulaglutide  INJECTION, SOLUTION  SUBCUTANEOUS           20140918   \n",
              "\n",
              "  ENDMARKETINGDATE MARKETINGCATEGORYNAME APPLICATIONNUMBER  \\\n",
              "0              NaN                   NDA         NDA018781   \n",
              "1              NaN                   NDA         NDA202008   \n",
              "2              NaN                   NDA         NDA007529   \n",
              "3              NaN                   BLA         BLA125469   \n",
              "4              NaN                   BLA         BLA125469   \n",
              "\n",
              "             LABELERNAME        SUBSTANCENAME ACTIVE_NUMERATOR_STRENGTH  \\\n",
              "0  Eli Lilly and Company                WATER                         1   \n",
              "1  Eli Lilly and Company     FLORBETAPIR F-18                        51   \n",
              "2  Eli Lilly and Company  QUINIDINE GLUCONATE                        80   \n",
              "3  Eli Lilly and Company          DULAGLUTIDE                       .75   \n",
              "4  Eli Lilly and Company          DULAGLUTIDE                       1.5   \n",
              "\n",
              "  ACTIVE_INGRED_UNIT                                      PHARM_CLASSES  \\\n",
              "0              mL/mL                                                NaN   \n",
              "1             mCi/mL  Radioactive Diagnostic Agent [EPC],Positron Em...   \n",
              "2              mg/mL  Antiarrhythmic [EPC],Cytochrome P450 2D6 Inhib...   \n",
              "3            mg/.5mL  GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...   \n",
              "4            mg/.5mL  GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...   \n",
              "\n",
              "  DEASCHEDULE NDC_EXCLUDE_FLAG LISTING_RECORD_CERTIFIED_THROUGH  \n",
              "0         NaN                N                         20191231  \n",
              "1         NaN                N                         20191231  \n",
              "2         NaN                N                         20191231  \n",
              "3         NaN                N                         20201231  \n",
              "4         NaN                N                         20201231  "
            ]
          },
          "execution_count": 3,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "ndc.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "i173jwVInhrO"
      },
      "outputs": [],
      "source": [
        "#we get values where the column is only strings.\n",
        "cert_through = ndc['LISTING_RECORD_CERTIFIED_THROUGH'].astype(str)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "wZehQOFonhrP"
      },
      "outputs": [],
      "source": [
        "#So we get a datetime using the string values of the first eight rows. We only saw the first five because we used the head command.\n",
        "\n",
        "end_date = pd.to_datetime(cert_through.str[0:8], format='%Y%m%d')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "u_3OU_KjnhrP",
        "outputId": "eb046c63-489c-451b-d789-d7fa1e999d2f"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "0   2019-12-31\n",
              "1   2019-12-31\n",
              "2   2019-12-31\n",
              "3   2020-12-31\n",
              "4   2020-12-31\n",
              "Name: LISTING_RECORD_CERTIFIED_THROUGH, dtype: datetime64[ns]"
            ]
          },
          "execution_count": 23,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "end_date.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "qoLlPAdqnhrQ"
      },
      "outputs": [],
      "source": [
        "#This creates a new column called end.\n",
        "ndc['end'] = end_date"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "BQR7o66_nhrR"
      },
      "outputs": [],
      "source": [
        "#The variable market_start is all the values from that column only as strings.\n",
        "market_start = ndc['STARTMARKETINGDATE'].astype(str)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "lIS7-wXxnhrS"
      },
      "outputs": [],
      "source": [
        "#Now we create a start column that is all the string values for the first eight rows.\n",
        "ndc['start'] = pd.to_datetime(market_start.str[0:8], format='%Y%m%d')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "JcIlf8tgnhrT",
        "outputId": "e2bff6a5-43c5-4721-9394-fc23e9dae40d"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>PRODUCTID</th>\n",
              "      <th>PRODUCTNDC</th>\n",
              "      <th>PRODUCTTYPENAME</th>\n",
              "      <th>PROPRIETARYNAME</th>\n",
              "      <th>PROPRIETARYNAMESUFFIX</th>\n",
              "      <th>NONPROPRIETARYNAME</th>\n",
              "      <th>DOSAGEFORMNAME</th>\n",
              "      <th>ROUTENAME</th>\n",
              "      <th>STARTMARKETINGDATE</th>\n",
              "      <th>ENDMARKETINGDATE</th>\n",
              "      <th>...</th>\n",
              "      <th>ACTIVE_NUMERATOR_STRENGTH</th>\n",
              "      <th>ACTIVE_INGRED_UNIT</th>\n",
              "      <th>PHARM_CLASSES</th>\n",
              "      <th>DEASCHEDULE</th>\n",
              "      <th>NDC_EXCLUDE_FLAG</th>\n",
              "      <th>LISTING_RECORD_CERTIFIED_THROUGH</th>\n",
              "      <th>end</th>\n",
              "      <th>start</th>\n",
              "      <th>duration</th>\n",
              "      <th>years</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0002-0800_4bb5d1cb-0fa7-48c7-9f6d-8d45f9b91649</td>\n",
              "      <td>0002-0800</td>\n",
              "      <td>HUMAN OTC DRUG</td>\n",
              "      <td>Sterile Diluent</td>\n",
              "      <td>NaN</td>\n",
              "      <td>diluent</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>19870710</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>mL/mL</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>1987-07-10</td>\n",
              "      <td>1987-07-10</td>\n",
              "      <td>0 days</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0002-1200_957ee1b5-dfa7-4e3f-96e1-6bed1ffc0abe</td>\n",
              "      <td>0002-1200</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Amyvid</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Florbetapir F 18</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>INTRAVENOUS</td>\n",
              "      <td>20120601</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>51</td>\n",
              "      <td>mCi/mL</td>\n",
              "      <td>Radioactive Diagnostic Agent [EPC],Positron Em...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>2012-06-01</td>\n",
              "      <td>2012-06-01</td>\n",
              "      <td>0 days</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0002-1407_14757f9d-f641-4836-acf3-229265588d1d</td>\n",
              "      <td>0002-1407</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Quinidine Gluconate</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Quinidine Gluconate</td>\n",
              "      <td>SOLUTION</td>\n",
              "      <td>INTRAVENOUS</td>\n",
              "      <td>19500712</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>80</td>\n",
              "      <td>mg/mL</td>\n",
              "      <td>Antiarrhythmic [EPC],Cytochrome P450 2D6 Inhib...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>1950-07-12</td>\n",
              "      <td>1950-07-12</td>\n",
              "      <td>0 days</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0002-1433_4468578a-47d2-488e-9fd4-a8322070392f</td>\n",
              "      <td>0002-1433</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Trulicity</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Dulaglutide</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>20140918</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>.75</td>\n",
              "      <td>mg/.5mL</td>\n",
              "      <td>GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2014-09-18</td>\n",
              "      <td>2014-09-18</td>\n",
              "      <td>0 days</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0002-1434_4468578a-47d2-488e-9fd4-a8322070392f</td>\n",
              "      <td>0002-1434</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Trulicity</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Dulaglutide</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>20140918</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>1.5</td>\n",
              "      <td>mg/.5mL</td>\n",
              "      <td>GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2014-09-18</td>\n",
              "      <td>2014-09-18</td>\n",
              "      <td>0 days</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>95</th>\n",
              "      <td>0003-0855_9bc9427b-2cca-466c-b41e-d47ce4540aa6</td>\n",
              "      <td>0003-0855</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>SPRYCEL</td>\n",
              "      <td>NaN</td>\n",
              "      <td>dasatinib</td>\n",
              "      <td>TABLET</td>\n",
              "      <td>ORAL</td>\n",
              "      <td>20101028</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>80</td>\n",
              "      <td>mg/1</td>\n",
              "      <td>Kinase Inhibitor [EPC],Protein Kinase Inhibito...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2010-10-28</td>\n",
              "      <td>2010-10-28</td>\n",
              "      <td>0 days</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>96</th>\n",
              "      <td>0003-0857_9bc9427b-2cca-466c-b41e-d47ce4540aa6</td>\n",
              "      <td>0003-0857</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>SPRYCEL</td>\n",
              "      <td>NaN</td>\n",
              "      <td>dasatinib</td>\n",
              "      <td>TABLET</td>\n",
              "      <td>ORAL</td>\n",
              "      <td>20101028</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>140</td>\n",
              "      <td>mg/1</td>\n",
              "      <td>Kinase Inhibitor [EPC],Protein Kinase Inhibito...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2010-10-28</td>\n",
              "      <td>2010-10-28</td>\n",
              "      <td>0 days</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>97</th>\n",
              "      <td>0003-0893_391cf576-1ae6-4a11-bf14-8e5a135cd5dd</td>\n",
              "      <td>0003-0893</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>ELIQUIS</td>\n",
              "      <td>NaN</td>\n",
              "      <td>apixaban</td>\n",
              "      <td>TABLET, FILM COATED</td>\n",
              "      <td>ORAL</td>\n",
              "      <td>20121228</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>2.5</td>\n",
              "      <td>mg/1</td>\n",
              "      <td>Factor Xa Inhibitor [EPC],Factor Xa Inhibitors...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2012-12-28</td>\n",
              "      <td>2012-12-28</td>\n",
              "      <td>0 days</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>98</th>\n",
              "      <td>0003-0894_391cf576-1ae6-4a11-bf14-8e5a135cd5dd</td>\n",
              "      <td>0003-0894</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>ELIQUIS</td>\n",
              "      <td>NaN</td>\n",
              "      <td>apixaban</td>\n",
              "      <td>TABLET, FILM COATED</td>\n",
              "      <td>ORAL</td>\n",
              "      <td>20121228</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>5</td>\n",
              "      <td>mg/1</td>\n",
              "      <td>Factor Xa Inhibitor [EPC],Factor Xa Inhibitors...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2012-12-28</td>\n",
              "      <td>2012-12-28</td>\n",
              "      <td>0 days</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>99</th>\n",
              "      <td>0003-1611_3beda2cb-720a-40f7-8377-20e552e4e85c</td>\n",
              "      <td>0003-1611</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>BARACLUDE</td>\n",
              "      <td>NaN</td>\n",
              "      <td>entecavir</td>\n",
              "      <td>TABLET, FILM COATED</td>\n",
              "      <td>ORAL</td>\n",
              "      <td>20050329</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>.5</td>\n",
              "      <td>mg/1</td>\n",
              "      <td>Hepatitis B Virus Nucleoside Analog Reverse Tr...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2005-03-29</td>\n",
              "      <td>2005-03-29</td>\n",
              "      <td>0 days</td>\n",
              "      <td>0.0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>100 rows × 24 columns</p>\n",
              "</div>"
            ],
            "text/plain": [
              "                                         PRODUCTID PRODUCTNDC  \\\n",
              "0   0002-0800_4bb5d1cb-0fa7-48c7-9f6d-8d45f9b91649  0002-0800   \n",
              "1   0002-1200_957ee1b5-dfa7-4e3f-96e1-6bed1ffc0abe  0002-1200   \n",
              "2   0002-1407_14757f9d-f641-4836-acf3-229265588d1d  0002-1407   \n",
              "3   0002-1433_4468578a-47d2-488e-9fd4-a8322070392f  0002-1433   \n",
              "4   0002-1434_4468578a-47d2-488e-9fd4-a8322070392f  0002-1434   \n",
              "..                                             ...        ...   \n",
              "95  0003-0855_9bc9427b-2cca-466c-b41e-d47ce4540aa6  0003-0855   \n",
              "96  0003-0857_9bc9427b-2cca-466c-b41e-d47ce4540aa6  0003-0857   \n",
              "97  0003-0893_391cf576-1ae6-4a11-bf14-8e5a135cd5dd  0003-0893   \n",
              "98  0003-0894_391cf576-1ae6-4a11-bf14-8e5a135cd5dd  0003-0894   \n",
              "99  0003-1611_3beda2cb-720a-40f7-8377-20e552e4e85c  0003-1611   \n",
              "\n",
              "            PRODUCTTYPENAME      PROPRIETARYNAME PROPRIETARYNAMESUFFIX  \\\n",
              "0            HUMAN OTC DRUG      Sterile Diluent                   NaN   \n",
              "1   HUMAN PRESCRIPTION DRUG               Amyvid                   NaN   \n",
              "2   HUMAN PRESCRIPTION DRUG  Quinidine Gluconate                   NaN   \n",
              "3   HUMAN PRESCRIPTION DRUG            Trulicity                   NaN   \n",
              "4   HUMAN PRESCRIPTION DRUG            Trulicity                   NaN   \n",
              "..                      ...                  ...                   ...   \n",
              "95  HUMAN PRESCRIPTION DRUG              SPRYCEL                   NaN   \n",
              "96  HUMAN PRESCRIPTION DRUG              SPRYCEL                   NaN   \n",
              "97  HUMAN PRESCRIPTION DRUG              ELIQUIS                   NaN   \n",
              "98  HUMAN PRESCRIPTION DRUG              ELIQUIS                   NaN   \n",
              "99  HUMAN PRESCRIPTION DRUG            BARACLUDE                   NaN   \n",
              "\n",
              "     NONPROPRIETARYNAME       DOSAGEFORMNAME     ROUTENAME STARTMARKETINGDATE  \\\n",
              "0               diluent  INJECTION, SOLUTION  SUBCUTANEOUS           19870710   \n",
              "1      Florbetapir F 18  INJECTION, SOLUTION   INTRAVENOUS           20120601   \n",
              "2   Quinidine Gluconate             SOLUTION   INTRAVENOUS           19500712   \n",
              "3           Dulaglutide  INJECTION, SOLUTION  SUBCUTANEOUS           20140918   \n",
              "4           Dulaglutide  INJECTION, SOLUTION  SUBCUTANEOUS           20140918   \n",
              "..                  ...                  ...           ...                ...   \n",
              "95            dasatinib               TABLET          ORAL           20101028   \n",
              "96            dasatinib               TABLET          ORAL           20101028   \n",
              "97             apixaban  TABLET, FILM COATED          ORAL           20121228   \n",
              "98             apixaban  TABLET, FILM COATED          ORAL           20121228   \n",
              "99            entecavir  TABLET, FILM COATED          ORAL           20050329   \n",
              "\n",
              "   ENDMARKETINGDATE  ... ACTIVE_NUMERATOR_STRENGTH ACTIVE_INGRED_UNIT  \\\n",
              "0               NaN  ...                         1              mL/mL   \n",
              "1               NaN  ...                        51             mCi/mL   \n",
              "2               NaN  ...                        80              mg/mL   \n",
              "3               NaN  ...                       .75            mg/.5mL   \n",
              "4               NaN  ...                       1.5            mg/.5mL   \n",
              "..              ...  ...                       ...                ...   \n",
              "95              NaN  ...                        80               mg/1   \n",
              "96              NaN  ...                       140               mg/1   \n",
              "97              NaN  ...                       2.5               mg/1   \n",
              "98              NaN  ...                         5               mg/1   \n",
              "99              NaN  ...                        .5               mg/1   \n",
              "\n",
              "                                        PHARM_CLASSES DEASCHEDULE  \\\n",
              "0                                                 NaN         NaN   \n",
              "1   Radioactive Diagnostic Agent [EPC],Positron Em...         NaN   \n",
              "2   Antiarrhythmic [EPC],Cytochrome P450 2D6 Inhib...         NaN   \n",
              "3   GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...         NaN   \n",
              "4   GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...         NaN   \n",
              "..                                                ...         ...   \n",
              "95  Kinase Inhibitor [EPC],Protein Kinase Inhibito...         NaN   \n",
              "96  Kinase Inhibitor [EPC],Protein Kinase Inhibito...         NaN   \n",
              "97  Factor Xa Inhibitor [EPC],Factor Xa Inhibitors...         NaN   \n",
              "98  Factor Xa Inhibitor [EPC],Factor Xa Inhibitors...         NaN   \n",
              "99  Hepatitis B Virus Nucleoside Analog Reverse Tr...         NaN   \n",
              "\n",
              "   NDC_EXCLUDE_FLAG LISTING_RECORD_CERTIFIED_THROUGH        end      start  \\\n",
              "0                 N                         20191231 1987-07-10 1987-07-10   \n",
              "1                 N                         20191231 2012-06-01 2012-06-01   \n",
              "2                 N                         20191231 1950-07-12 1950-07-12   \n",
              "3                 N                         20201231 2014-09-18 2014-09-18   \n",
              "4                 N                         20201231 2014-09-18 2014-09-18   \n",
              "..              ...                              ...        ...        ...   \n",
              "95                N                         20201231 2010-10-28 2010-10-28   \n",
              "96                N                         20201231 2010-10-28 2010-10-28   \n",
              "97                N                         20201231 2012-12-28 2012-12-28   \n",
              "98                N                         20201231 2012-12-28 2012-12-28   \n",
              "99                N                         20201231 2005-03-29 2005-03-29   \n",
              "\n",
              "   duration years  \n",
              "0    0 days   0.0  \n",
              "1    0 days   0.0  \n",
              "2    0 days   0.0  \n",
              "3    0 days   0.0  \n",
              "4    0 days   0.0  \n",
              "..      ...   ...  \n",
              "95   0 days   0.0  \n",
              "96   0 days   0.0  \n",
              "97   0 days   0.0  \n",
              "98   0 days   0.0  \n",
              "99   0 days   0.0  \n",
              "\n",
              "[100 rows x 24 columns]"
            ]
          },
          "execution_count": 20,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "ndc.head(100)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "08sSLgwanhrU"
      },
      "source": [
        "# Date Differences\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "2C9W2d6NnhrW",
        "outputId": "cd3f7529-0c45-4fd9-c7d5-531072e2b75d"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "0         32.0\n",
              "1          7.0\n",
              "2         69.0\n",
              "3          6.0\n",
              "4          6.0\n",
              "          ... \n",
              "126637     9.0\n",
              "126638     9.0\n",
              "126639    13.0\n",
              "126640     6.0\n",
              "126641     9.0\n",
              "Length: 126642, dtype: float64"
            ]
          },
          "execution_count": 13,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "# Time on market\n",
        "\n",
        "#So we get the end date minus the start date as a timedelta64 data type.\n",
        "\n",
        "(ndc['end'] - ndc['start']).astype('timedelta64[Y]')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "M33NjnnPnhrW",
        "outputId": "3470d779-d807-4d64-b2a5-934eafaa4b91"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>PRODUCTID</th>\n",
              "      <th>PRODUCTNDC</th>\n",
              "      <th>PRODUCTTYPENAME</th>\n",
              "      <th>PROPRIETARYNAME</th>\n",
              "      <th>PROPRIETARYNAMESUFFIX</th>\n",
              "      <th>NONPROPRIETARYNAME</th>\n",
              "      <th>DOSAGEFORMNAME</th>\n",
              "      <th>ROUTENAME</th>\n",
              "      <th>STARTMARKETINGDATE</th>\n",
              "      <th>ENDMARKETINGDATE</th>\n",
              "      <th>...</th>\n",
              "      <th>LABELERNAME</th>\n",
              "      <th>SUBSTANCENAME</th>\n",
              "      <th>ACTIVE_NUMERATOR_STRENGTH</th>\n",
              "      <th>ACTIVE_INGRED_UNIT</th>\n",
              "      <th>PHARM_CLASSES</th>\n",
              "      <th>DEASCHEDULE</th>\n",
              "      <th>NDC_EXCLUDE_FLAG</th>\n",
              "      <th>LISTING_RECORD_CERTIFIED_THROUGH</th>\n",
              "      <th>end</th>\n",
              "      <th>start</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0002-0800_4bb5d1cb-0fa7-48c7-9f6d-8d45f9b91649</td>\n",
              "      <td>0002-0800</td>\n",
              "      <td>HUMAN OTC DRUG</td>\n",
              "      <td>Sterile Diluent</td>\n",
              "      <td>NaN</td>\n",
              "      <td>diluent</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>19870710</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>Eli Lilly and Company</td>\n",
              "      <td>WATER</td>\n",
              "      <td>1</td>\n",
              "      <td>mL/mL</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>2019-12-31</td>\n",
              "      <td>1987-07-10</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0002-1200_957ee1b5-dfa7-4e3f-96e1-6bed1ffc0abe</td>\n",
              "      <td>0002-1200</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Amyvid</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Florbetapir F 18</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>INTRAVENOUS</td>\n",
              "      <td>20120601</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>Eli Lilly and Company</td>\n",
              "      <td>FLORBETAPIR F-18</td>\n",
              "      <td>51</td>\n",
              "      <td>mCi/mL</td>\n",
              "      <td>Radioactive Diagnostic Agent [EPC],Positron Em...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>2019-12-31</td>\n",
              "      <td>2012-06-01</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0002-1407_14757f9d-f641-4836-acf3-229265588d1d</td>\n",
              "      <td>0002-1407</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Quinidine Gluconate</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Quinidine Gluconate</td>\n",
              "      <td>SOLUTION</td>\n",
              "      <td>INTRAVENOUS</td>\n",
              "      <td>19500712</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>Eli Lilly and Company</td>\n",
              "      <td>QUINIDINE GLUCONATE</td>\n",
              "      <td>80</td>\n",
              "      <td>mg/mL</td>\n",
              "      <td>Antiarrhythmic [EPC],Cytochrome P450 2D6 Inhib...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>2019-12-31</td>\n",
              "      <td>1950-07-12</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0002-1433_4468578a-47d2-488e-9fd4-a8322070392f</td>\n",
              "      <td>0002-1433</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Trulicity</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Dulaglutide</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>20140918</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>Eli Lilly and Company</td>\n",
              "      <td>DULAGLUTIDE</td>\n",
              "      <td>.75</td>\n",
              "      <td>mg/.5mL</td>\n",
              "      <td>GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2020-12-31</td>\n",
              "      <td>2014-09-18</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0002-1434_4468578a-47d2-488e-9fd4-a8322070392f</td>\n",
              "      <td>0002-1434</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Trulicity</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Dulaglutide</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>20140918</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>Eli Lilly and Company</td>\n",
              "      <td>DULAGLUTIDE</td>\n",
              "      <td>1.5</td>\n",
              "      <td>mg/.5mL</td>\n",
              "      <td>GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2020-12-31</td>\n",
              "      <td>2014-09-18</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>5 rows × 22 columns</p>\n",
              "</div>"
            ],
            "text/plain": [
              "                                        PRODUCTID PRODUCTNDC  \\\n",
              "0  0002-0800_4bb5d1cb-0fa7-48c7-9f6d-8d45f9b91649  0002-0800   \n",
              "1  0002-1200_957ee1b5-dfa7-4e3f-96e1-6bed1ffc0abe  0002-1200   \n",
              "2  0002-1407_14757f9d-f641-4836-acf3-229265588d1d  0002-1407   \n",
              "3  0002-1433_4468578a-47d2-488e-9fd4-a8322070392f  0002-1433   \n",
              "4  0002-1434_4468578a-47d2-488e-9fd4-a8322070392f  0002-1434   \n",
              "\n",
              "           PRODUCTTYPENAME      PROPRIETARYNAME PROPRIETARYNAMESUFFIX  \\\n",
              "0           HUMAN OTC DRUG      Sterile Diluent                   NaN   \n",
              "1  HUMAN PRESCRIPTION DRUG               Amyvid                   NaN   \n",
              "2  HUMAN PRESCRIPTION DRUG  Quinidine Gluconate                   NaN   \n",
              "3  HUMAN PRESCRIPTION DRUG            Trulicity                   NaN   \n",
              "4  HUMAN PRESCRIPTION DRUG            Trulicity                   NaN   \n",
              "\n",
              "    NONPROPRIETARYNAME       DOSAGEFORMNAME     ROUTENAME STARTMARKETINGDATE  \\\n",
              "0              diluent  INJECTION, SOLUTION  SUBCUTANEOUS           19870710   \n",
              "1     Florbetapir F 18  INJECTION, SOLUTION   INTRAVENOUS           20120601   \n",
              "2  Quinidine Gluconate             SOLUTION   INTRAVENOUS           19500712   \n",
              "3          Dulaglutide  INJECTION, SOLUTION  SUBCUTANEOUS           20140918   \n",
              "4          Dulaglutide  INJECTION, SOLUTION  SUBCUTANEOUS           20140918   \n",
              "\n",
              "  ENDMARKETINGDATE  ...            LABELERNAME        SUBSTANCENAME  \\\n",
              "0              NaN  ...  Eli Lilly and Company                WATER   \n",
              "1              NaN  ...  Eli Lilly and Company     FLORBETAPIR F-18   \n",
              "2              NaN  ...  Eli Lilly and Company  QUINIDINE GLUCONATE   \n",
              "3              NaN  ...  Eli Lilly and Company          DULAGLUTIDE   \n",
              "4              NaN  ...  Eli Lilly and Company          DULAGLUTIDE   \n",
              "\n",
              "  ACTIVE_NUMERATOR_STRENGTH ACTIVE_INGRED_UNIT  \\\n",
              "0                         1              mL/mL   \n",
              "1                        51             mCi/mL   \n",
              "2                        80              mg/mL   \n",
              "3                       .75            mg/.5mL   \n",
              "4                       1.5            mg/.5mL   \n",
              "\n",
              "                                       PHARM_CLASSES DEASCHEDULE  \\\n",
              "0                                                NaN         NaN   \n",
              "1  Radioactive Diagnostic Agent [EPC],Positron Em...         NaN   \n",
              "2  Antiarrhythmic [EPC],Cytochrome P450 2D6 Inhib...         NaN   \n",
              "3  GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...         NaN   \n",
              "4  GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...         NaN   \n",
              "\n",
              "  NDC_EXCLUDE_FLAG LISTING_RECORD_CERTIFIED_THROUGH        end      start  \n",
              "0                N                         20191231 2019-12-31 1987-07-10  \n",
              "1                N                         20191231 2019-12-31 2012-06-01  \n",
              "2                N                         20191231 2019-12-31 1950-07-12  \n",
              "3                N                         20201231 2020-12-31 2014-09-18  \n",
              "4                N                         20201231 2020-12-31 2014-09-18  \n",
              "\n",
              "[5 rows x 22 columns]"
            ]
          },
          "execution_count": 14,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "ndc.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "DvunjGlxnhrX"
      },
      "outputs": [],
      "source": [
        "import numpy as np\n",
        "\n",
        "#Create a new column called duration that is end minus start.\n",
        "# New column called years that is just the duration column which is a timedelta divided by a time delta to make it more precise.\n",
        "#We choose to get an integer number of years by using the 'Y'.\n",
        "ndc['duration'] = ndc['end'] - ndc['start']\n",
        "ndc['years'] = ndc.duration // np.timedelta64(1, 'Y')"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "7t5nUy9wnhrX",
        "outputId": "e7baf75a-84cf-4177-9d37-920097fac69a"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>PRODUCTID</th>\n",
              "      <th>PRODUCTNDC</th>\n",
              "      <th>PRODUCTTYPENAME</th>\n",
              "      <th>PROPRIETARYNAME</th>\n",
              "      <th>PROPRIETARYNAMESUFFIX</th>\n",
              "      <th>NONPROPRIETARYNAME</th>\n",
              "      <th>DOSAGEFORMNAME</th>\n",
              "      <th>ROUTENAME</th>\n",
              "      <th>STARTMARKETINGDATE</th>\n",
              "      <th>ENDMARKETINGDATE</th>\n",
              "      <th>...</th>\n",
              "      <th>ACTIVE_NUMERATOR_STRENGTH</th>\n",
              "      <th>ACTIVE_INGRED_UNIT</th>\n",
              "      <th>PHARM_CLASSES</th>\n",
              "      <th>DEASCHEDULE</th>\n",
              "      <th>NDC_EXCLUDE_FLAG</th>\n",
              "      <th>LISTING_RECORD_CERTIFIED_THROUGH</th>\n",
              "      <th>end</th>\n",
              "      <th>start</th>\n",
              "      <th>duration</th>\n",
              "      <th>years</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0002-0800_4bb5d1cb-0fa7-48c7-9f6d-8d45f9b91649</td>\n",
              "      <td>0002-0800</td>\n",
              "      <td>HUMAN OTC DRUG</td>\n",
              "      <td>Sterile Diluent</td>\n",
              "      <td>NaN</td>\n",
              "      <td>diluent</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>19870710</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>1</td>\n",
              "      <td>mL/mL</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>2019-12-31</td>\n",
              "      <td>1987-07-10</td>\n",
              "      <td>11862 days</td>\n",
              "      <td>32.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0002-1200_957ee1b5-dfa7-4e3f-96e1-6bed1ffc0abe</td>\n",
              "      <td>0002-1200</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Amyvid</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Florbetapir F 18</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>INTRAVENOUS</td>\n",
              "      <td>20120601</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>51</td>\n",
              "      <td>mCi/mL</td>\n",
              "      <td>Radioactive Diagnostic Agent [EPC],Positron Em...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>2019-12-31</td>\n",
              "      <td>2012-06-01</td>\n",
              "      <td>2769 days</td>\n",
              "      <td>7.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0002-1407_14757f9d-f641-4836-acf3-229265588d1d</td>\n",
              "      <td>0002-1407</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Quinidine Gluconate</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Quinidine Gluconate</td>\n",
              "      <td>SOLUTION</td>\n",
              "      <td>INTRAVENOUS</td>\n",
              "      <td>19500712</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>80</td>\n",
              "      <td>mg/mL</td>\n",
              "      <td>Antiarrhythmic [EPC],Cytochrome P450 2D6 Inhib...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>2019-12-31</td>\n",
              "      <td>1950-07-12</td>\n",
              "      <td>25374 days</td>\n",
              "      <td>69.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0002-1433_4468578a-47d2-488e-9fd4-a8322070392f</td>\n",
              "      <td>0002-1433</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Trulicity</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Dulaglutide</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>20140918</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>.75</td>\n",
              "      <td>mg/.5mL</td>\n",
              "      <td>GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2020-12-31</td>\n",
              "      <td>2014-09-18</td>\n",
              "      <td>2296 days</td>\n",
              "      <td>6.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0002-1434_4468578a-47d2-488e-9fd4-a8322070392f</td>\n",
              "      <td>0002-1434</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Trulicity</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Dulaglutide</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>20140918</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>1.5</td>\n",
              "      <td>mg/.5mL</td>\n",
              "      <td>GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2020-12-31</td>\n",
              "      <td>2014-09-18</td>\n",
              "      <td>2296 days</td>\n",
              "      <td>6.0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>5 rows × 24 columns</p>\n",
              "</div>"
            ],
            "text/plain": [
              "                                        PRODUCTID PRODUCTNDC  \\\n",
              "0  0002-0800_4bb5d1cb-0fa7-48c7-9f6d-8d45f9b91649  0002-0800   \n",
              "1  0002-1200_957ee1b5-dfa7-4e3f-96e1-6bed1ffc0abe  0002-1200   \n",
              "2  0002-1407_14757f9d-f641-4836-acf3-229265588d1d  0002-1407   \n",
              "3  0002-1433_4468578a-47d2-488e-9fd4-a8322070392f  0002-1433   \n",
              "4  0002-1434_4468578a-47d2-488e-9fd4-a8322070392f  0002-1434   \n",
              "\n",
              "           PRODUCTTYPENAME      PROPRIETARYNAME PROPRIETARYNAMESUFFIX  \\\n",
              "0           HUMAN OTC DRUG      Sterile Diluent                   NaN   \n",
              "1  HUMAN PRESCRIPTION DRUG               Amyvid                   NaN   \n",
              "2  HUMAN PRESCRIPTION DRUG  Quinidine Gluconate                   NaN   \n",
              "3  HUMAN PRESCRIPTION DRUG            Trulicity                   NaN   \n",
              "4  HUMAN PRESCRIPTION DRUG            Trulicity                   NaN   \n",
              "\n",
              "    NONPROPRIETARYNAME       DOSAGEFORMNAME     ROUTENAME STARTMARKETINGDATE  \\\n",
              "0              diluent  INJECTION, SOLUTION  SUBCUTANEOUS           19870710   \n",
              "1     Florbetapir F 18  INJECTION, SOLUTION   INTRAVENOUS           20120601   \n",
              "2  Quinidine Gluconate             SOLUTION   INTRAVENOUS           19500712   \n",
              "3          Dulaglutide  INJECTION, SOLUTION  SUBCUTANEOUS           20140918   \n",
              "4          Dulaglutide  INJECTION, SOLUTION  SUBCUTANEOUS           20140918   \n",
              "\n",
              "  ENDMARKETINGDATE  ... ACTIVE_NUMERATOR_STRENGTH ACTIVE_INGRED_UNIT  \\\n",
              "0              NaN  ...                         1              mL/mL   \n",
              "1              NaN  ...                        51             mCi/mL   \n",
              "2              NaN  ...                        80              mg/mL   \n",
              "3              NaN  ...                       .75            mg/.5mL   \n",
              "4              NaN  ...                       1.5            mg/.5mL   \n",
              "\n",
              "                                       PHARM_CLASSES DEASCHEDULE  \\\n",
              "0                                                NaN         NaN   \n",
              "1  Radioactive Diagnostic Agent [EPC],Positron Em...         NaN   \n",
              "2  Antiarrhythmic [EPC],Cytochrome P450 2D6 Inhib...         NaN   \n",
              "3  GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...         NaN   \n",
              "4  GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...         NaN   \n",
              "\n",
              "  NDC_EXCLUDE_FLAG LISTING_RECORD_CERTIFIED_THROUGH        end      start  \\\n",
              "0                N                         20191231 2019-12-31 1987-07-10   \n",
              "1                N                         20191231 2019-12-31 2012-06-01   \n",
              "2                N                         20191231 2019-12-31 1950-07-12   \n",
              "3                N                         20201231 2020-12-31 2014-09-18   \n",
              "4                N                         20201231 2020-12-31 2014-09-18   \n",
              "\n",
              "    duration years  \n",
              "0 11862 days  32.0  \n",
              "1  2769 days   7.0  \n",
              "2 25374 days  69.0  \n",
              "3  2296 days   6.0  \n",
              "4  2296 days   6.0  \n",
              "\n",
              "[5 rows x 24 columns]"
            ]
          },
          "execution_count": 26,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "ndc.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "8Q5tJgK0nhrY",
        "outputId": "268d13e7-9ac9-4f1b-bda1-735d0ae40fa4"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "(126642, 25)"
            ]
          },
          "execution_count": 29,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "ndc.shape"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "zpAs_WgtnhrY"
      },
      "outputs": [],
      "source": [
        "#We are ranking the data set by the year they were born.\n",
        "ndc['age rank'] = ndc.years.rank()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "MYZZR88OnhrY",
        "outputId": "e6b33b2b-e917-4c66-f97a-079ad01e4e9a"
      },
      "outputs": [
        {
          "data": {
            "text/html": [
              "<div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>PRODUCTID</th>\n",
              "      <th>PRODUCTNDC</th>\n",
              "      <th>PRODUCTTYPENAME</th>\n",
              "      <th>PROPRIETARYNAME</th>\n",
              "      <th>PROPRIETARYNAMESUFFIX</th>\n",
              "      <th>NONPROPRIETARYNAME</th>\n",
              "      <th>DOSAGEFORMNAME</th>\n",
              "      <th>ROUTENAME</th>\n",
              "      <th>STARTMARKETINGDATE</th>\n",
              "      <th>ENDMARKETINGDATE</th>\n",
              "      <th>...</th>\n",
              "      <th>ACTIVE_INGRED_UNIT</th>\n",
              "      <th>PHARM_CLASSES</th>\n",
              "      <th>DEASCHEDULE</th>\n",
              "      <th>NDC_EXCLUDE_FLAG</th>\n",
              "      <th>LISTING_RECORD_CERTIFIED_THROUGH</th>\n",
              "      <th>end</th>\n",
              "      <th>start</th>\n",
              "      <th>duration</th>\n",
              "      <th>years</th>\n",
              "      <th>age rank</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0002-0800_4bb5d1cb-0fa7-48c7-9f6d-8d45f9b91649</td>\n",
              "      <td>0002-0800</td>\n",
              "      <td>HUMAN OTC DRUG</td>\n",
              "      <td>Sterile Diluent</td>\n",
              "      <td>NaN</td>\n",
              "      <td>diluent</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>19870710</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>mL/mL</td>\n",
              "      <td>NaN</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>2019-12-31</td>\n",
              "      <td>1987-07-10</td>\n",
              "      <td>11862 days</td>\n",
              "      <td>32.0</td>\n",
              "      <td>113733.5</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>0002-1200_957ee1b5-dfa7-4e3f-96e1-6bed1ffc0abe</td>\n",
              "      <td>0002-1200</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Amyvid</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Florbetapir F 18</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>INTRAVENOUS</td>\n",
              "      <td>20120601</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>mCi/mL</td>\n",
              "      <td>Radioactive Diagnostic Agent [EPC],Positron Em...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>2019-12-31</td>\n",
              "      <td>2012-06-01</td>\n",
              "      <td>2769 days</td>\n",
              "      <td>7.0</td>\n",
              "      <td>70495.5</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0002-1407_14757f9d-f641-4836-acf3-229265588d1d</td>\n",
              "      <td>0002-1407</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Quinidine Gluconate</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Quinidine Gluconate</td>\n",
              "      <td>SOLUTION</td>\n",
              "      <td>INTRAVENOUS</td>\n",
              "      <td>19500712</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>mg/mL</td>\n",
              "      <td>Antiarrhythmic [EPC],Cytochrome P450 2D6 Inhib...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20191231</td>\n",
              "      <td>2019-12-31</td>\n",
              "      <td>1950-07-12</td>\n",
              "      <td>25374 days</td>\n",
              "      <td>69.0</td>\n",
              "      <td>122115.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0002-1433_4468578a-47d2-488e-9fd4-a8322070392f</td>\n",
              "      <td>0002-1433</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Trulicity</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Dulaglutide</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>20140918</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>mg/.5mL</td>\n",
              "      <td>GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2020-12-31</td>\n",
              "      <td>2014-09-18</td>\n",
              "      <td>2296 days</td>\n",
              "      <td>6.0</td>\n",
              "      <td>61988.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0002-1434_4468578a-47d2-488e-9fd4-a8322070392f</td>\n",
              "      <td>0002-1434</td>\n",
              "      <td>HUMAN PRESCRIPTION DRUG</td>\n",
              "      <td>Trulicity</td>\n",
              "      <td>NaN</td>\n",
              "      <td>Dulaglutide</td>\n",
              "      <td>INJECTION, SOLUTION</td>\n",
              "      <td>SUBCUTANEOUS</td>\n",
              "      <td>20140918</td>\n",
              "      <td>NaN</td>\n",
              "      <td>...</td>\n",
              "      <td>mg/.5mL</td>\n",
              "      <td>GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...</td>\n",
              "      <td>NaN</td>\n",
              "      <td>N</td>\n",
              "      <td>20201231</td>\n",
              "      <td>2020-12-31</td>\n",
              "      <td>2014-09-18</td>\n",
              "      <td>2296 days</td>\n",
              "      <td>6.0</td>\n",
              "      <td>61988.0</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>5 rows × 25 columns</p>\n",
              "</div>"
            ],
            "text/plain": [
              "                                        PRODUCTID PRODUCTNDC  \\\n",
              "0  0002-0800_4bb5d1cb-0fa7-48c7-9f6d-8d45f9b91649  0002-0800   \n",
              "1  0002-1200_957ee1b5-dfa7-4e3f-96e1-6bed1ffc0abe  0002-1200   \n",
              "2  0002-1407_14757f9d-f641-4836-acf3-229265588d1d  0002-1407   \n",
              "3  0002-1433_4468578a-47d2-488e-9fd4-a8322070392f  0002-1433   \n",
              "4  0002-1434_4468578a-47d2-488e-9fd4-a8322070392f  0002-1434   \n",
              "\n",
              "           PRODUCTTYPENAME      PROPRIETARYNAME PROPRIETARYNAMESUFFIX  \\\n",
              "0           HUMAN OTC DRUG      Sterile Diluent                   NaN   \n",
              "1  HUMAN PRESCRIPTION DRUG               Amyvid                   NaN   \n",
              "2  HUMAN PRESCRIPTION DRUG  Quinidine Gluconate                   NaN   \n",
              "3  HUMAN PRESCRIPTION DRUG            Trulicity                   NaN   \n",
              "4  HUMAN PRESCRIPTION DRUG            Trulicity                   NaN   \n",
              "\n",
              "    NONPROPRIETARYNAME       DOSAGEFORMNAME     ROUTENAME STARTMARKETINGDATE  \\\n",
              "0              diluent  INJECTION, SOLUTION  SUBCUTANEOUS           19870710   \n",
              "1     Florbetapir F 18  INJECTION, SOLUTION   INTRAVENOUS           20120601   \n",
              "2  Quinidine Gluconate             SOLUTION   INTRAVENOUS           19500712   \n",
              "3          Dulaglutide  INJECTION, SOLUTION  SUBCUTANEOUS           20140918   \n",
              "4          Dulaglutide  INJECTION, SOLUTION  SUBCUTANEOUS           20140918   \n",
              "\n",
              "  ENDMARKETINGDATE  ... ACTIVE_INGRED_UNIT  \\\n",
              "0              NaN  ...              mL/mL   \n",
              "1              NaN  ...             mCi/mL   \n",
              "2              NaN  ...              mg/mL   \n",
              "3              NaN  ...            mg/.5mL   \n",
              "4              NaN  ...            mg/.5mL   \n",
              "\n",
              "                                       PHARM_CLASSES DEASCHEDULE  \\\n",
              "0                                                NaN         NaN   \n",
              "1  Radioactive Diagnostic Agent [EPC],Positron Em...         NaN   \n",
              "2  Antiarrhythmic [EPC],Cytochrome P450 2D6 Inhib...         NaN   \n",
              "3  GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...         NaN   \n",
              "4  GLP-1 Receptor Agonist [EPC],Glucagon-Like Pep...         NaN   \n",
              "\n",
              "  NDC_EXCLUDE_FLAG LISTING_RECORD_CERTIFIED_THROUGH        end      start  \\\n",
              "0                N                         20191231 2019-12-31 1987-07-10   \n",
              "1                N                         20191231 2019-12-31 2012-06-01   \n",
              "2                N                         20191231 2019-12-31 1950-07-12   \n",
              "3                N                         20201231 2020-12-31 2014-09-18   \n",
              "4                N                         20201231 2020-12-31 2014-09-18   \n",
              "\n",
              "    duration years  age rank  \n",
              "0 11862 days  32.0  113733.5  \n",
              "1  2769 days   7.0   70495.5  \n",
              "2 25374 days  69.0  122115.0  \n",
              "3  2296 days   6.0   61988.0  \n",
              "4  2296 days   6.0   61988.0  \n",
              "\n",
              "[5 rows x 25 columns]"
            ]
          },
          "execution_count": 28,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "ndc.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "LX1Cl_ysnhrY"
      },
      "outputs": [],
      "source": [
        "#We are doing a filter with a start date after 1900 sorted by ascending age rank.\n",
        "ndc[ndc.start > '1900-12-31'].sort_values('age rank',ascending=False).head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "AwdSHvM2nhrZ"
      },
      "outputs": [],
      "source": [
        "%matplotlib inline"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "SMqaVTADnhrZ",
        "outputId": "64fc71c7-fe2f-4028-d4a4-cb107322080e"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "<matplotlib.axes._subplots.AxesSubplot at 0x7f5bb6116c18>"
            ]
          },
          "execution_count": 31,
          "metadata": {},
          "output_type": "execute_result"
        },
        {
          "data": {
            "image/png": "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\n",
            "text/plain": [
              "<Figure size 432x288 with 1 Axes>"
            ]
          },
          "metadata": {
            "needs_background": "light"
          },
          "output_type": "display_data"
        }
      ],
      "source": [
        "#Most of the people are not that old.\n",
        "ndc.years.hist()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "LtlBvBiJnhrZ"
      },
      "outputs": [],
      "source": [
        "#Create a reminder column that that reminds you 20 business days in advance.\n",
        "ndc['reminder'] = ndc['end'] - pd.offsets.BDay(20)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "ogeR1C7cnhra"
      },
      "outputs": [],
      "source": [
        "ndc.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "cV3B6fzpnhra"
      },
      "outputs": [],
      "source": []
    }
  ],
  "metadata": {
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.6.7"
    },
    "colab": {
      "provenance": [],
      "include_colab_link": true
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}